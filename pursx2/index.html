<!DOCTYPE html>
  <html>
    <head>
      <title>Deku documentation</title>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width">
      <link rel="stylesheet" href="../style.css">
      <script type="module">
        import { main } from "../bundle.js";
        main({"startsWith":"PURSX2","slug":"/purescript-deku/"})();
      </script>
    </head><body  data-deku-ssr--648823="true"><div  data-deku-ssr--517285="true"><div  data-deku-ssr--34570="true"><span  data-deku-ssr-448145="true"><a style"cursor:pointer;" href"/purescript-deku/" data-deku-ssr-930860="true"><!---586426-->Home</a><span style"" data-deku-ssr--200254="true"><!--282461--> | </span></span><span  data-deku-ssr-668633="true"><a style"cursor:pointer;" href"/purescript-deku/hello/" data-deku-ssr--848653="true"><!---365938-->Hello world</a><span style"" data-deku-ssr-20234="true"><!--502949--> | </span></span><span  data-deku-ssr-889121="true"><a style"cursor:pointer;" href"/purescript-deku/simple/" data-deku-ssr--628165="true"><!---145450-->Component</a><span style"" data-deku-ssr-240722="true"><!--723437--> | </span></span><span  data-deku-ssr--890392="true"><a style"cursor:pointer;" href"/purescript-deku/pursx1/" data-deku-ssr--407677="true"><!--75038-->Pursx 1</a><span style"" data-deku-ssr-461210="true"><!--943925--> | </span></span><span  data-deku-ssr--669904="true"><a style"cursor:pointer;" href"/purescript-deku/events1/" data-deku-ssr--187189="true"><!--295526-->Events 1</a><span style"" data-deku-ssr-681698="true"><!---835588--> | </span></span><span  data-deku-ssr--449416="true"><a style"cursor:pointer;" href"/purescript-deku/effects/" data-deku-ssr-33299="true"><!--516014-->Effects</a><span style"" data-deku-ssr-902186="true"><!---615100--> | </span></span><span  data-deku-ssr--228928="true"><a style"cursor:pointer;" href"/purescript-deku/pursx2/" data-deku-ssr-253787="true"><!--736502-->Pursx 2</a><span style"" data-deku-ssr--877327="true"><!---394612--> | </span></span><span  data-deku-ssr--8440="true"><a style"cursor:pointer;" href"/purescript-deku/events2/" data-deku-ssr-474275="true"><!--956990-->Events 2</a><span style"" data-deku-ssr--656839="true"><!---174124--> | </span></span><span  data-deku-ssr-212048="true"><a style"cursor:pointer;" href"/purescript-deku/portals/" data-deku-ssr-694763="true"><!---822523-->Portals</a><span style"" data-deku-ssr--436351="true"><!--46364--> | </span></span><span  data-deku-ssr-432536="true"><a style"cursor:pointer;" href"/purescript-deku/ssr/" data-deku-ssr-915251="true"><!---602035-->SSR</a><span style"display:none;" data-deku-ssr--215863="true"><!--266852--> | </span></span></div><div  data-deku-ssr-653024="true"><div data-deku-ssr--574633="true">
  <h1>Pursx 2</h1>

  <h2>Working with events and effects</h2>
  <p>
    PursX would be of limited utility if it could only render static content. In this section, we'll see how to make it dynamic, both by modifying existing elements and inserting entirely new ones.
  </p>

  <p>The example below is the same one from the Pursx 1 section with two differences. The first is that the background color of the second list item is set dynamically. The second is that there is a new button that is dynamically inserted.
  </p>

  <span style="display:contents;" data-deku-elt-internal="code@-478090"><pre  data-deku-ssr--381547="true"><code  data-deku-ssr-101168="true"><!--583883-->module Main where

import Prelude

import Control.Alt ((&#60;|&#62;))
import Data.Compactable (compact)
import Data.Maybe (Maybe(..))
import Deku.Attribute (cb, (:=))
import Deku.Control (text)
import Deku.DOM as D
import Deku.Pursx (nut, (~~))
import Deku.Toplevel (runInBody1)
import Effect (Effect)
import FRP.Event (bus, bang)
import Type.Proxy (Proxy(..))

myDom =
  Proxy :: Proxy """&#60;div&#62;
        &#60;button&#62;I do nothing&#60;/button&#62;
        &#60;ul&#62;
          &#60;li&#62;A&#60;/li&#62;
          &#60;li ~myli~&#62;B&#60;/li&#62;
          &#60;li&#62;C&#60;/li&#62;
        &#60;/ul&#62;
        &#60;div&#62;
          &#60;a href="https://github.com/mikesol/purescript-deku"&#62;&#60;/a&#62;
          &#60;i&#62;bar&#60;/i&#62;
          ~somethingNew~
          &#60;span style="font-weight:800;"&#62;baz&#60;/span&#62;
        &#60;/div&#62;
        &#60;div&#62;&#60;div&#62;&#60;/div&#62;&#60;div&#62;&#60;input type="range"/&#62;&#60;/div&#62;&#60;/div&#62;
      &#60;/div&#62;
"""

main :: Effect Unit
main = runInBody1
  ( bus \push event -&#62; myDom ~~
      { myli: bang (D.Style := "background-color:rgb(200,240,210);")
      , somethingNew: nut
          ( D.button (bang (D.OnClick := push (Just unit)))
              [ text
                  $ (compact event $&#62; "Thanks for clicking me!") &#60;|&#62;
                    bang "I was dynamically inserted"
              ]
          )
      }
  )</code></pre></span>

  <p>And here's what it produces:</p>

  <blockquote> <span style="display:contents;" data-deku-elt-internal="result@-478090"><div data-deku-ssr--933403="true">
        <button>I do nothing</button>
        <ul>
          <li>A</li>
          <li data-deku-attr-internal="myli@-836860">B</li>
          <li>C</li>
        </ul>
        <div>
          <a href="https://github.com/mikesol/purescript-deku"></a>
          <i>bar</i>
          <span style="display:contents;" data-deku-elt-internal="somethingNew@-836860"><button  data-deku-ssr--740317="true"><!---257602-->I was dynamically inserted</button></span>
          <span style="font-weight:800;">baz</span>
        </div>
        <div><div></div><div><input type="range"/></div></div>
      </div></span> </blockquote>

  <h2>Dynamism in static content</h2>
  <p>Named slots for dynamic content are added to PursX with between two tildes, like <code>~foo~</code>. This separator doesn't have to be a tilde - it can be set programatically as well (see the Deku/Pursx.purs module for an example of how that is done). Also, we no longer use the <code>psx</code> command. Instead, we use the infix operator <code>~~</code> followed by arguments to our template. In the case of dynamic attributes, the argument is a stream of attributes. In the case of a dynamic section, the arguments are of type <code>Element</code>.</p>

  <h2>Next steps</h2>
  <p>In more complicated apps, like this documentation, we'll need dynamic logic that allows for components to replace each other, for example in a navigation bar. In the next section, we'll see one way to do this by using <a data-deku-attr-internal="next@-478090" style="cursor:pointer;">events to control the presence and absence of elements</a>.</p>
</div></div></div></body></html>
