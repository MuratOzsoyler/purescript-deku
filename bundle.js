var Jp=function(t){return function(r){for(var e=t.length,n=r.length,u=new Array(e*n),o=0,c=0;c<e;c++)for(var l=t[c],v=0;v<n;v++)u[o++]=l(r[v]);return u}};var $u={compose:function(t){return function(r){return function(e){return t(r(e))}}}},fu=function(t){return t.compose};var kt=function(t){return t.identity},st={identity:function(t){return t},Semigroupoid0:function(){return $u}};var ce=!0;var Qf=function(t){return function(r){return function(e){return function(n){return t(r(e))(r(n))}}}},dr=function(t){return function(r){return function(e){return t(e)(r)}}},g=function(t){return function(r){return t}};var Za=function(t){return function(r){return r(t)}};var jp=function(t){return function(r){for(var e=r.length,n=new Array(e),u=0;u<e;u++)n[u]=t(r[u]);return n}};var z=function(){function t(){}return t.value=new t,t}();var k=function(t){return t.map},Ue=function(t){return function(r){return function(e){return k(t)(e)(r)}}},at=function(t){return k(t)(g(void 0))},N=function(t){return function(r){return function(e){return k(t)(g(e))(r)}}},ei=function(t){return function(r){return k(t)(g(r))}};var qe={map:fu($u)},Ar={map:jp};var Ka={apply:Jp,Functor0:function(){return Ar}},It=function(t){return t.apply};var mt=function(t){return function(r){return function(e){return It(t)(k(t.Functor0())(g(kt(st)))(r))(e)}}},be=function(t){return function(r){return function(e){return function(n){return It(t)(k(t.Functor0())(r)(e))(n)}}}};var p=function(t){return t.pure};var Wn=function(t){return function(r){return function(e){if(r)return e;if(!r)return p(t)(void 0);throw new Error("Failed pattern match at Control.Applicative (line 63, column 1 - line 63, column 63): "+[r.constructor.name,e.constructor.name])}}},to=function(t){return function(r){return function(e){return It(t.Apply0())(p(t)(r))(e)}}};var ro={pure:function(t){return[t]},Apply0:function(){return Ka}};var Gp=function(t){return function(r){return t+r}},Qp=function(t){return function(r){return t.length===0?r:r.length===0?t:t.concat(r)}};var Ur=function(t){return t.reflectSymbol};var he=function(t){return function(r){return r[t]}},Un=function(t){return function(r){return function(e){var n={};for(var u in e)({}).hasOwnProperty.call(e,u)&&(n[u]=e[u]);return n[t]=r,n}}};var Zp={append:function(t){return function(r){return void 0}}},qn={append:Gp};var sr={append:Qp};var W=function(t){return t.append};var ft=function(t){return t.alt};var jb=String.fromCharCode(65535),Xb=String.fromCharCode(0),Gb=Number.POSITIVE_INFINITY,Qb=Number.NEGATIVE_INFINITY;var Kp=function(t){return function(r){return function(e){return function(n){return function(u){return n<u?t:n===u?r:e}}}}};var t_=Kp;var r_=Kp;var e_=function(t){return function(r){return t===r}};var n_=e_;var u_=e_;var cu={eq:u_};var eo={eq:n_};var Et=function(t){return t.eq};var gt=function(){function t(){}return t.value=new t,t}(),Ft=function(){function t(){}return t.value=new t,t}(),$t=function(){function t(){}return t.value=new t,t}();var a_=function(t){return function(r){return t-r|0}};var o_=function(t){return function(r){return t+r|0}},i_=function(t){return function(r){return t*r|0}},f_=function(t){return function(r){return t+r}},c_=function(t){return function(r){return t*r}};var no={add:f_,zero:0,mul:c_,one:1},Le={add:o_,zero:0,mul:i_,one:1};var Ve=function(t){return t.mul};var Pr=function(t){return t.add};var Zf={sub:a_,Semiring0:function(){return Le}};var re=function(){return{compare:r_(gt.value)($t.value)(Ft.value),Eq0:function(){return cu}}}();var de=function(){return{compare:t_(gt.value)($t.value)(Ft.value),Eq0:function(){return eo}}}();var Tt=function(t){return t.compare};var Je=function(t){return t.top};var Mu={top:2147483647,bottom:-2147483648,Ord0:function(){return de}};var un=function(t){return t.bottom};var p_=function(t){return t.toString()},__=function(t){var r=t.toString();return isNaN(r+".0")?r:r+".0"};var s_=function(t){var r=t.length;return'"'+t.replace(/[\0-\x1F\x7F"\\]/g,function(e,n){switch(e){case'"':case"\\":return"\\"+e;case"\x07":return"\\a";case"\b":return"\\b";case"\f":return"\\f";case`
`:return"\\n";case"\r":return"\\r";case"	":return"\\t";case"\v":return"\\v"}var u=n+1,o=u<r&&t[u]>="0"&&t[u]<="9"?"\\&":"";return"\\"+e.charCodeAt(0).toString(10)+o})+'"'};var v_=function(t){return function(r){return[t].concat(r)}},ui=function(t){return function(r){return r.join(t)}};var Ae={show:s_},m_={showRecordFields:function(t){return function(r){return[]}}},D_=function(t){return t.showRecordFields},b_=function(){return function(){return function(t){return{show:function(r){var e=D_(t)(z.value)(r);return e.length===0?"{}":ui(" ")(["{",ui(", ")(e),"}"])}}}}};var ao={show:__},je={show:p_};var tt=function(t){return t.show};var tc=function(t){return function(r){return function(e){return{showRecordFields:function(n){return function(u){var o=D_(r)(z.value)(u),c=Ur(t)(z.value),l=he(c)(u);return v_(ui(": ")([c,tt(e)(l)]))(o)}}}}}};var w=function(){function t(){}return t.value=new t,t}(),C=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}();var Qt=function(t){return function(r){return function(e){if(e instanceof w)return t;if(e instanceof C)return r(e.value0);throw new Error("Failed pattern match at Data.Maybe (line 237, column 1 - line 237, column 51): "+[t.constructor.name,r.constructor.name,e.constructor.name])}}};var na=Qt(!1)(g(!0));var pr={map:function(t){return function(r){return r instanceof C?new C(t(r.value0)):w.value}}};var pe=function(t){return Qt(t)(kt(st))},Ee=function(){return function(t){if(t instanceof C)return t.value0;throw new Error("Failed pattern match at Data.Maybe (line 288, column 1 - line 288, column 46): "+[t.constructor.name])}};var xu={apply:function(t){return function(r){if(t instanceof C)return k(pr)(t.value0)(r);if(t instanceof w)return w.value;throw new Error("Failed pattern match at Data.Maybe (line 67, column 1 - line 69, column 30): "+[t.constructor.name,r.constructor.name])}},Functor0:function(){return pr}},$e={bind:function(t){return function(r){if(t instanceof C)return r(t.value0);if(t instanceof w)return w.value;throw new Error("Failed pattern match at Data.Maybe (line 125, column 1 - line 127, column 28): "+[t.constructor.name,r.constructor.name])}},Apply0:function(){return xu}};var Vr=function(){return{pure:C.create,Apply0:function(){return xu}}}();var vd={alt:function(t){return function(r){return t instanceof w?r:t}},Functor0:function(){return pr}},k_=function(){return{empty:w.value,Alt0:function(){return vd}}}();var y_=function(t){return Math.min(Math.abs(t),2147483647)},g_=function(t){return function(r){return r===0?0:r>0?Math.floor(t/r):-Math.floor(t/-r)}},C_=function(t){return function(r){if(r===0)return 0;var e=Math.abs(r);return(t%e+e)%e}};var T_={Ring0:function(){return Zf}};var oo=function(t){return t.mod};var oi={degree:y_,div:g_,mod:C_,CommutativeRing0:function(){return T_}};var Xe={mempty:void 0,Semigroup0:function(){return Zp}},io={mempty:"",Semigroup0:function(){return qn}};var xt=function(t){return t.mempty};var ua=function(t){return{always:g(xt(t)),Monoid0:function(){return t}}},aa=function(t){return{always:kt(st),Monoid0:function(){return t}}},fo=function(t){return t.always};var it=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),et=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}();var nc=function(t){return Qt(new it(t))(et.create)};var oa={map:function(t){return function(r){if(r instanceof it)return new it(r.value0);if(r instanceof et)return new et(t(r.value0));throw new Error("Failed pattern match at Data.Either (line 31, column 1 - line 31, column 52): "+[r.constructor.name])}}};var Ge=function(t){return function(r){return function(e){if(e instanceof it)return t(e.value0);if(e instanceof et)return r(e.value0);throw new Error("Failed pattern match at Data.Either (line 208, column 1 - line 208, column 64): "+[t.constructor.name,r.constructor.name,e.constructor.name])}}},uc=function(){return Ge(g(w.value))(C.create)}();var y=function(t){return t.empty};var S_=function(t){return function(r){return function(e){for(var n=r,u=e.length,o=u-1;o>=0;o--)n=t(e[o])(n);return n}}},h_=function(t){return function(r){return function(e){for(var n=r,u=e.length,o=0;o<u;o++)n=t(n)(e[o]);return n}}};var E_=function(t){return function(r){for(var e=[],n=0,u=t.length;n<u;n++)Array.prototype.push.apply(e,r(t[n]));return e}};var jt=function(t){return t.discard};var fi={bind:E_,Apply0:function(){return Ka}},L=function(t){return t.bind},Vn=function(t){return dr(L(t))},ci=function(t){return function(r){return function(e){return function(n){return Vn(t)(r)(e(n))}}}},li=function(t){return function(r){return function(e){return function(n){return L(t)(r(n))(e)}}}};var Xt={discard:function(t){return L(t)}};var wu=function(t){return function(r){return L(t)(r)(kt(st))}};var Td=function(t,r,e){var n=0,u;return function(o){if(n===2)return u;if(n===1)throw new ReferenceError(t+" was needed before it finished initializing (module "+r+", line "+o+")",r,o);return n=1,u=e(),n=2,u}};var M_={defer:function(t){return function(r){return t(void 0)(r)}}},ia=function(t){return t.defer},oc=function(t){return function(r){var e=Td("go","Control.Lazy",function(){return ia(t)(function(u){return r(e(25))})}),n=e(25);return n}};var x_=function(t){return function(r){return t&&r}},w_=function(t){return function(r){return t||r}},I_=function(t){return!t};var Qe=function(t){return t.not};var ca=function(t){return t.ff};var Iu=function(t){return t.disj},_e={ff:!1,tt:!0,implies:function(t){return function(r){return Iu(_e)(Qe(_e)(t))(r)}},conj:x_,disj:w_,not:I_};var H=function(){function t(r,e){this.value0=r,this.value1=e}return t.create=function(r){return function(e){return new t(r,e)}},t}();var Jr=function(t){return t.value1};var Lu={map:function(t){return function(r){return new H(r.value0,t(r.value1))}}};var _o=function(t){return t};var Ld=function(t){return{append:function(r){return function(e){return Iu(t)(r)(e)}}}};var cc=function(t){return{mempty:ca(t),Semigroup0:function(){return Ld(t)}}};var Pd=function(t){return{append:function(r){return function(e){return fu(t)(r)(e)}}}};var Ou=function(t){return{mempty:kt(t),Semigroup0:function(){return Pd(t.Semigroupoid0())}}};var q=function(t){return t};var kn=function(){return q};var Er=kn;var bi=function(){return function(){return function(){return function(){return function(t){return kn()}}}}};var er=function(t){return t.foldr};var _a=function(t){return function(r){return er(t)(ft(r.Alt0()))(y(r))}},Dr=function(t){return function(r){return function(e){return er(t)(function(){var n=ft(r.Alt0());return function(u){return n(e(u))}}())(y(r))}}},Pe=function(t){return function(r){return function(e){return er(r)(function(){var n=mt(t.Apply0());return function(u){return n(e(u))}}())(p(t)(void 0))}}},qr=function(t){return function(r){return dr(Pe(t)(r))}},di=function(t){return function(r){return Pe(t)(r)(kt(st))}},nr=function(t){return t.foldl};var Jn=function(t){return function(r){return function(e){return function(n){var u=function(o){return function(c){return o.init?{init:!1,acc:c}:{init:!1,acc:W(r.Semigroup0())(o.acc)(W(r.Semigroup0())(e)(c))}}};return nr(t)(u)({init:!0,acc:xt(r)})(n).acc}}}};var zr={foldr:function(t){return function(r){return function(e){if(e instanceof w)return r;if(e instanceof C)return t(e.value0)(r);throw new Error("Failed pattern match at Data.Foldable (line 138, column 1 - line 144, column 27): "+[t.constructor.name,r.constructor.name,e.constructor.name])}}},foldl:function(t){return function(r){return function(e){if(e instanceof w)return r;if(e instanceof C)return t(r)(e.value0);throw new Error("Failed pattern match at Data.Foldable (line 138, column 1 - line 144, column 27): "+[t.constructor.name,r.constructor.name,e.constructor.name])}}},foldMap:function(t){return function(r){return function(e){if(e instanceof w)return xt(t);if(e instanceof C)return r(e.value0);throw new Error("Failed pattern match at Data.Foldable (line 138, column 1 - line 144, column 27): "+[r.constructor.name,e.constructor.name])}}}};var R_=function(t){return function(r){return function(e){return er(t)(function(n){return function(u){return W(r.Semigroup0())(e(n))(u)}})(xt(r))}}},ct={foldr:S_,foldl:h_,foldMap:function(t){return R_(ct)(t)}};var xr=function(t){return t.foldMap};var pu=function(t){return function(r){return bi()()()()(_o)(xr(t)(cc(r)))}};var N_=function(t){return function(r){for(var e=r.length,n=Array(e),u=0;u<e;u++)n[u]=t(u)(r[u]);return n}};var yn=function(t){return t};var gn={map:function(t){return function(r){return t(r)}}};var W_={apply:function(t){return function(r){return t(r)}},Functor0:function(){return gn}},Bd={bind:function(t){return function(r){return r(t)}},Apply0:function(){return W_}},Hd={pure:yn,Apply0:function(){return W_}},mr={Applicative0:function(){return Hd},Bind1:function(){return Bd}};var Xn=function(t){return t.mapWithIndex};var va={mapWithIndex:N_,Functor0:function(){return Ar}};var Tn=function(t){return t.foldrWithIndex};var Ye=function(t){return t.foldlWithIndex};var Gn=function(t){return t.foldMapWithIndex};var j_=function(){function t(u){return[u]}function r(u){return function(o){return[u,o]}}function e(u){return function(o){return function(c){return[u,o,c]}}}function n(u){return function(o){return u.concat(o)}}return function(u){return function(o){return function(c){return function(l){return function(v){function s(m,b){switch(b-m){case 0:return c([]);case 1:return o(t)(l(v[m]));case 2:return u(o(r)(l(v[m])))(l(v[m+1]));case 3:return u(u(o(e)(l(v[m])))(l(v[m+1])))(l(v[m+2]));default:var D=m+Math.floor((b-m)/4)*2;return u(o(n)(s(m,D)))(s(D,b))}}return s(0,v.length)}}}}}}();var ke=function(t){return t.traverse};var Q_=function(t){return function(r){return ke(t)(r)(kt(st))}},Qn={traverse:function(t){return j_(It(t.Apply0()))(k(t.Apply0().Functor0()))(p(t))},sequence:function(t){return Q_(Qn)(t)},Functor0:function(){return Ar},Foldable1:function(){return ct}};var Sn=function(){function t(r,e){this.value0=r,this.value1=e}return t.create=function(r){return function(e){return new t(r,e)}},t}();var Ei=function(t){return function(r){return new Sn(r,y(t))}};var br=function(){function t(){}return t.value=new t,t}(),bt=function(){function t(r,e){this.value0=r,this.value1=e}return t.create=function(r){return function(e){return new t(r,e)}},t}(),$i=function(t){return t},UA=function(t){return new bt(t.value0,t.value1)};var qA=function(t){var r=function(e){return function(n){var u=e,o=!1,c;function l(v,s){if(s instanceof bt&&s.value1 instanceof bt&&s.value1.value1 instanceof bt){u=new bt(s,v),n=s.value1.value1.value1;return}var m=function(D){return D instanceof bt&&D.value1 instanceof bt&&D.value1.value1 instanceof br?new bt(t(D.value0),new bt(t(D.value1.value0),br.value)):D instanceof bt&&D.value1 instanceof br?new bt(t(D.value0),br.value):br.value},b=function(D){return function(a){var A=D,Q=!1,Pt;function tr(zt,we){if(zt instanceof bt&&zt.value0 instanceof bt&&zt.value0.value1 instanceof bt&&zt.value0.value1.value1 instanceof bt){A=zt.value1,a=new bt(t(zt.value0.value0),new bt(t(zt.value0.value1.value0),new bt(t(zt.value0.value1.value1.value0),we)));return}return Q=!0,we}for(;!Q;)Pt=tr(A,a);return Pt}};return o=!0,b(v)(m(s))}for(;!o;)c=l(u,n);return c}};return r(br.value)},yc={map:qA};var Ze={foldr:function(t){return function(r){var e=function(){var u=function(o){return function(c){var l=o,v=!1,s;function m(b,D){if(D instanceof br)return v=!0,b;if(D instanceof bt){l=new bt(D.value0,b),c=D.value1;return}throw new Error("Failed pattern match at Data.List.Types (line 107, column 7 - line 107, column 23): "+[b.constructor.name,D.constructor.name])}for(;!v;)s=m(l,c);return s}};return u(br.value)}(),n=nr(Ze)(dr(t))(r);return function(u){return n(e(u))}}},foldl:function(t){var r=function(e){return function(n){var u=e,o=!1,c;function l(v,s){if(s instanceof br)return o=!0,v;if(s instanceof bt){u=t(v)(s.value0),n=s.value1;return}throw new Error("Failed pattern match at Data.List.Types (line 111, column 12 - line 113, column 30): "+[s.constructor.name])}for(;!o;)c=l(u,n);return c}};return r},foldMap:function(t){return function(r){return nr(Ze)(function(e){var n=W(t.Semigroup0())(e);return function(u){return n(r(u))}})(xt(t))}}};var Do={append:function(t){return function(r){return er(Ze)(bt.create)(r)(t)}}};var gc={append:function(t){return function(r){return new Sn(t.value0,W(Do)(t.value1)(UA(r)))}}};var ts={alt:W(Do),Functor0:function(){return yc}},Cc=function(){return{empty:br.value,Alt0:function(){return ts}}}();var rs=function(t){return t()};var es=function(t){throw new Error(t)};var ns=function(){return es};var jA=rs,fn=function(t){return jA(function(){return ns()(t)})};function os(t){var r={};for(var e in t)({}).hasOwnProperty.call(t,e)&&(r[e]=t[e]);return r}function is(t){return function(r){return function(e){return e[t]=r(e[t]),e}}}var Sc=function(t){return function(r){return function(e){return function(n){return t(r,e,n)}}}};var cs=$u;var ls=function(){return function(){return function(t){return function(r){return function(e){return function(n){return is(Ur(t)(r))(e)(n)}}}}}};var ps=st,_s=function(t){return function(r){return t(os(r))}};var ck=function(t){return t},lk=function(t){return t.mappingWithIndex};var pk=function(t){return t.mapping};var Fi={mapRecordWithIndexBuilder:function(t){return function(r){return kt(ps)}}},ss=function(t){return t.mapRecordWithIndexBuilder},ba=function(t){return function(r){return function(e){return function(){return function(){return{mapRecordWithIndexBuilder:function(n){return function(u){return fu(cs)(ls()()(t)(z.value)(lk(r)(u)(z.value)))(ss(e)(z.value)(u))}}}}}}}};var vs=function(){return function(t){return{hmap:function(){var r=ss(t)(z.value);return function(e){return _s(r(ck(e)))}}()}}};var ms=function(t){return t.hmap},da=function(t){return{mappingWithIndex:function(r){return function(e){return pk(t)(r)}}}};var _k=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),Aa=function(t){return function(r){return{mapping:function(e){return k(qe)(fo(t))}}}},Ds=function(t){return function(r){return ms(t)(new _k(r))}};var bs=q;var ds=function(t){return function(r){return function(){return t(r())}}},As=function(t){return function(){return t}},ks=function(t){return function(r){return function(){return r(t())()}}};function kr(t){return function(){return{value:t}}}var _r=function(t){return function(){return t.value}},ys=function(t){return function(r){return function(){var e=t(r.value);return r.value=e.state,e.value}}},Or=function(t){return function(r){return function(){return r.value=t}}};var Ke=function(t){return function(r){return function(e){return L(t.Bind1())(r)(function(n){return L(t.Bind1())(e)(function(u){return p(t.Applicative0())(n(u))})})}}};var Fc=function(t){return function(){return t}},gs=function(t){return function(r){return function(){return r(t())()}}};var Cs=function(t,r,e){var n=0,u;return function(o){if(n===2)return u;if(n===1)throw new ReferenceError(t+" was needed before it finished initializing (module "+r+", line "+o+")",r,o);return n=1,u=e(),n=2,u}},ka={Applicative0:function(){return ie},Bind1:function(){return Hu}},Hu={bind:gs,Apply0:function(){return Mc(0)}},ie={pure:Fc,Apply0:function(){return Mc(0)}},Ts=Cs("functorEffect","Effect",function(){return{map:to(ie)}}),Mc=Cs("applyEffect","Effect",function(){return{apply:Ke(ka),Functor0:function(){return Ts(0)}}}),O=Ts(20),or=Mc(23),Ss=function(t){return{append:be(or)(W(t))}},ln=function(t){return{mempty:Fc(xt(t)),Semigroup0:function(){return Ss(t.Semigroup0())}}};var hs=function(t){return function(){return{value:t}}};var vu=function(t){return function(){return t.value}},Es=function(t){return function(r){return function(){var e=t(r.value);return r.value=e.state,e.value}}},Ao=function(t){return function(r){return function(){r.value=t}}};var Wu=hs,bk=Es,xc=function(t){return bk(function(r){var e=t(r);return{state:e,value:e}})},wc=function(t){return function(r){return at(O)(xc(t)(r))}};var gk=function(t,r,e){var n=0,u;return function(o){if(n===2)return u;if(n===1)throw new ReferenceError(t+" was needed before it finished initializing (module "+r+", line "+o+")",r,o);return n=1,u=e(),n=2,u}},Ck=ys,Rr=function(t){return Ck(function(r){var e=t(r);return{state:e,value:e}})},yr={map:ds},xi={Applicative0:function(){return se},Bind1:function(){return wi}},wi={bind:ks,Apply0:function(){return Ic(0)}},se={pure:As,Apply0:function(){return Ic(0)}},Ic=gk("applyST","Control.Monad.ST.Internal",function(){return{apply:Ke(xi),Functor0:function(){return yr}}}),Fs=Ic(46);var Ms={liftST:kt(st),Monad0:function(){return xi}},xs={liftST:bs,Monad0:function(){return ka}},X=function(t){return t.liftST};var Tk=function(t){return function(r){if(t<1)return[];var e=new Array(t);return e.fill(r)}},Sk=function(t){return function(r){for(var e=[],n=0,u=0;u<t;u++)e[n++]=r;return e}},Lc=typeof Array.prototype.fill=="function"?Tk:Sk,hk=function(){function t(u,o){this.head=u,this.tail=o}var r={};function e(u){return function(o){return new t(u,o)}}function n(u){for(var o=[],c=0,l=u;l!==r;)o[c++]=l.head,l=l.tail;return o}return function(u){return function(o){return n(u(e)(r)(o))}}}(),En=function(t){return t.length};var ws=function(t){return function(r){return function(e){return function(n){return n<0||n>=e.length?r:t(e[n])}}}},Is=function(t){return function(r){return function(e){return function(n){for(var u=0;u<n.length;u++){var o=e(n[u]);if(r(o))return o}return t}}}},Ls=function(t){return function(r){return function(e){return function(n){for(var u=0,o=n.length;u<o;u++)if(e(n[u]))return t(u);return r}}}};var Ps=function(t){return function(r){return function(e){return function(n){if(e<0||e>=n.length)return r;var u=n.slice();return u.splice(e,1),t(u)}}}};var yo=function(t){return function(r){return r.filter(t)}},Li=function(t){return function(r){for(var e=[],n=[],u=0;u<r.length;u++){var o=r[u];t(o)?e.push(o):n.push(o)}return{yes:e,no:n}}};var Ek=function(){function t(r,e,n,u,o,c){var l,v,s,m,b,D,a;for(l=o+(c-o>>1),l-o>1&&t(r,e,u,n,o,l),c-l>1&&t(r,e,u,n,l,c),v=o,s=l,m=o;v<l&&s<c;)b=u[v],D=u[s],a=e(r(b)(D)),a>0?(n[m++]=D,++s):(n[m++]=b,++v);for(;v<l;)n[m++]=u[v++];for(;s<c;)n[m++]=u[s++]}return function(r){return function(e){return function(n){var u;return n.length<2?n:(u=n.slice(0),t(r,e,u,n.slice(0),0,n.length),u)}}}}();var Os=function(t){return function(r){return t[r]}};function $n(){return[]}var Pc=function(t){return function(r){return function(){return r.push.apply(r,t)}}};var Pi=function(t){return function(r){return function(e){return function(n){return function(){return n.splice.apply(n,[t,r].concat(e))}}}}},Fn=function(t){return function(){return t}};function Rs(t){return function(){return t.slice()}}var Oi=Rs,Oc=Rs,Fk=function(){function t(r,e,n,u,o,c){var l,v,s,m,b,D,a;for(l=o+(c-o>>1),l-o>1&&t(r,e,u,n,o,l),c-l>1&&t(r,e,u,n,l,c),v=o,s=l,m=o;v<l&&s<c;)b=u[v],D=u[s],a=e(r(b)(D)),a>0?(n[m++]=D,++s):(n[m++]=b,++v);for(;v<l;)n[m++]=u[v++];for(;s<c;)n[m++]=u[s++]}return function(r){return function(e){return function(n){return function(){return n.length<2||t(r,e,n,n.slice(0),0,n.length),n}}}}}();var Ws=function(t){return function(r){return function(){var n=Oc(r)();return t(n)(),Fn(n)()}}};var tn=function(t){return Pc([t])};var wk=function(){function t(r,e){this.value0=r,this.value1=e}return t.create=function(r){return function(e){return new t(r,e)}},t}();var Ik=function(t){return function(){var e=_r(t.value1)();return Rr(function(n){return n+1|0})(t.value1)(),t.value0(e)}};var Ri=function(t){return k(yr)(wk.create(t))(kr(0))},Ni=function(t){return function(r){return function(){for(var n=kr(!1)();k(yr)(Qe(_e))(_r(n))();)(function(){var o=Ik(t)();if(o instanceof C)return r(o.value0)();if(o instanceof w)return at(yr)(Or(!0)(n))();throw new Error("Failed pattern match at Data.Array.ST.Iterator (line 42, column 5 - line 44, column 47): "+[o.constructor.name])})();return{}}}};var Js=function(){return Os};var Bi=function(t){return function(r){return Ws(tn(r))(t)()}},js=function(t){return[t]};var Uu=function(){return ws(C.create)(w.value)}(),Bc=function(t){return Uu(t)(En(t)-1|0)};var Hi=function(){return Is(w.value)(na)}();var Hc=function(){return Ls(C.create)(w.value)}();var Wc=function(t){return function(r){return k(pr)(Js()(r))(Hc(t)(r))}};var Xs=function(){return Ps(C.create)(w.value)}(),Wi=function(t){return function(r){return function(e){return e.length===0?[]:Qt(e)(function(n){return Ee()(Xs(n)(e))})(Hc(t(r))(e))}}};var go=function(t){return function(r){return W(sr)([t])(r)}};var Bk=dr(L(fi)),Uc=function(t){return Bk(function(){var r=Qt([])(js);return function(e){return r(t(e))}}())};var nt=function(){function t(){}return t.value=new t,t}(),dt=function(){function t(r,e,n,u){this.value0=r,this.value1=e,this.value2=n,this.value3=u}return t.create=function(r){return function(e){return function(n){return function(u){return new t(r,e,n,u)}}}},t}(),Bt=function(){function t(r,e,n,u,o,c,l){this.value0=r,this.value1=e,this.value2=n,this.value3=u,this.value4=o,this.value5=c,this.value6=l}return t.create=function(r){return function(e){return function(n){return function(u){return function(o){return function(c){return function(l){return new t(r,e,n,u,o,c,l)}}}}}}},t}(),mu=function(){function t(r,e,n){this.value0=r,this.value1=e,this.value2=n}return t.create=function(r){return function(e){return function(n){return new t(r,e,n)}}},t}(),Yn=function(){function t(r,e,n){this.value0=r,this.value1=e,this.value2=n}return t.create=function(r){return function(e){return function(n){return new t(r,e,n)}}},t}(),Du=function(){function t(r,e,n,u,o,c){this.value0=r,this.value1=e,this.value2=n,this.value3=u,this.value4=o,this.value5=c}return t.create=function(r){return function(e){return function(n){return function(u){return function(o){return function(c){return new t(r,e,n,u,o,c)}}}}}},t}(),Mn=function(){function t(r,e,n,u,o,c){this.value0=r,this.value1=e,this.value2=n,this.value3=u,this.value4=o,this.value5=c}return t.create=function(r){return function(e){return function(n){return function(u){return function(o){return function(c){return new t(r,e,n,u,o,c)}}}}}},t}(),bu=function(){function t(r,e,n,u,o,c){this.value0=r,this.value1=e,this.value2=n,this.value3=u,this.value4=o,this.value5=c}return t.create=function(r){return function(e){return function(n){return function(u){return function(o){return function(c){return new t(r,e,n,u,o,c)}}}}}},t}(),qi=function(){function t(r,e,n,u){this.value0=r,this.value1=e,this.value2=n,this.value3=u}return t.create=function(r){return function(e){return function(n){return function(u){return new t(r,e,n,u)}}}},t}();var ev=function(t){return function(r){return new dt(nt.value,t,r,nt.value)}};var Ca=function(t){return function(r){var e=Tt(t),n=function(u){var o=!1,c;function l(v){if(v instanceof nt)return o=!0,w.value;if(v instanceof dt){var s=e(r)(v.value1);if(s instanceof $t)return o=!0,new C(v.value2);if(s instanceof gt){u=v.value0;return}u=v.value3;return}if(v instanceof Bt){var m=e(r)(v.value1);if(m instanceof $t)return o=!0,new C(v.value2);var b=e(r)(v.value4);if(b instanceof $t)return o=!0,new C(v.value5);if(m instanceof gt){u=v.value0;return}if(b instanceof Ft){u=v.value6;return}u=v.value3;return}throw new Error("Failed pattern match at Data.Map.Internal (line 241, column 5 - line 241, column 22): "+[v.constructor.name])}for(;!o;)c=l(u);return c};return n}};var wr=function(t){return function(r){return function(e){var n=t,u=r,o=!1,c;function l(v,s,m){if(s instanceof br)return o=!0,m;if(s instanceof bt){if(s.value0 instanceof mu){n=v,u=s.value1,e=new dt(m,s.value0.value0,s.value0.value1,s.value0.value2);return}if(s.value0 instanceof Yn){n=v,u=s.value1,e=new dt(s.value0.value0,s.value0.value1,s.value0.value2,m);return}if(s.value0 instanceof Du){n=v,u=s.value1,e=new Bt(m,s.value0.value0,s.value0.value1,s.value0.value2,s.value0.value3,s.value0.value4,s.value0.value5);return}if(s.value0 instanceof Mn){n=v,u=s.value1,e=new Bt(s.value0.value0,s.value0.value1,s.value0.value2,m,s.value0.value3,s.value0.value4,s.value0.value5);return}if(s.value0 instanceof bu){n=v,u=s.value1,e=new Bt(s.value0.value0,s.value0.value1,s.value0.value2,s.value0.value3,s.value0.value4,s.value0.value5,m);return}throw new Error("Failed pattern match at Data.Map.Internal (line 462, column 3 - line 467, column 88): "+[s.value0.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 459, column 1 - line 459, column 80): "+[s.constructor.name,m.constructor.name])}for(;!o;)c=l(n,u,e);return c}}},Vi=function(t){return function(r){return function(e){var n=function(c){return function(l){var v=c,s=!1,m;function b(D,a){if(D instanceof br)return s=!0,new dt(a.value0,a.value1,a.value2,a.value3);if(D instanceof bt){if(D.value0 instanceof mu)return s=!0,wr(t)(D.value1)(new Bt(a.value0,a.value1,a.value2,a.value3,D.value0.value0,D.value0.value1,D.value0.value2));if(D.value0 instanceof Yn)return s=!0,wr(t)(D.value1)(new Bt(D.value0.value0,D.value0.value1,D.value0.value2,a.value0,a.value1,a.value2,a.value3));if(D.value0 instanceof Du){v=D.value1,l=new qi(new dt(a.value0,a.value1,a.value2,a.value3),D.value0.value0,D.value0.value1,new dt(D.value0.value2,D.value0.value3,D.value0.value4,D.value0.value5));return}if(D.value0 instanceof Mn){v=D.value1,l=new qi(new dt(D.value0.value0,D.value0.value1,D.value0.value2,a.value0),a.value1,a.value2,new dt(a.value3,D.value0.value3,D.value0.value4,D.value0.value5));return}if(D.value0 instanceof bu){v=D.value1,l=new qi(new dt(D.value0.value0,D.value0.value1,D.value0.value2,D.value0.value3),D.value0.value4,D.value0.value5,new dt(a.value0,a.value1,a.value2,a.value3));return}throw new Error("Failed pattern match at Data.Map.Internal (line 498, column 5 - line 503, column 108): "+[D.value0.constructor.name,a.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 495, column 3 - line 495, column 56): "+[D.constructor.name,a.constructor.name])}for(;!s;)m=b(v,l);return m}},u=Tt(t),o=function(c){return function(l){var v=c,s=!1,m;function b(D,a){if(a instanceof nt)return s=!0,n(D)(new qi(nt.value,r,e,nt.value));if(a instanceof dt){var A=u(r)(a.value1);if(A instanceof $t)return s=!0,wr(t)(D)(new dt(a.value0,r,e,a.value3));if(A instanceof gt){v=new bt(new mu(a.value1,a.value2,a.value3),D),l=a.value0;return}v=new bt(new Yn(a.value0,a.value1,a.value2),D),l=a.value3;return}if(a instanceof Bt){var Q=u(r)(a.value1);if(Q instanceof $t)return s=!0,wr(t)(D)(new Bt(a.value0,r,e,a.value3,a.value4,a.value5,a.value6));var Pt=u(r)(a.value4);if(Pt instanceof $t)return s=!0,wr(t)(D)(new Bt(a.value0,a.value1,a.value2,a.value3,r,e,a.value6));if(Q instanceof gt){v=new bt(new Du(a.value1,a.value2,a.value3,a.value4,a.value5,a.value6),D),l=a.value0;return}if(Q instanceof Ft&&Pt instanceof gt){v=new bt(new Mn(a.value0,a.value1,a.value2,a.value4,a.value5,a.value6),D),l=a.value3;return}v=new bt(new bu(a.value0,a.value1,a.value2,a.value3,a.value4,a.value5),D),l=a.value6;return}throw new Error("Failed pattern match at Data.Map.Internal (line 478, column 3 - line 478, column 55): "+[D.constructor.name,a.constructor.name])}for(;!s;)m=b(v,l);return m}};return o(br.value)}}},ay=function(t){return function(r){var e=function(l){return function(v){var s=l,m=!1,b;function D(a,A){if(a instanceof br)return m=!0,A;if(a instanceof bt){if(a.value0 instanceof mu&&a.value0.value2 instanceof nt&&A instanceof nt)return m=!0,wr(t)(a.value1)(new dt(nt.value,a.value0.value0,a.value0.value1,nt.value));if(a.value0 instanceof Yn&&a.value0.value0 instanceof nt&&A instanceof nt)return m=!0,wr(t)(a.value1)(new dt(nt.value,a.value0.value1,a.value0.value2,nt.value));if(a.value0 instanceof mu&&a.value0.value2 instanceof dt){s=a.value1,v=new Bt(A,a.value0.value0,a.value0.value1,a.value0.value2.value0,a.value0.value2.value1,a.value0.value2.value2,a.value0.value2.value3);return}if(a.value0 instanceof Yn&&a.value0.value0 instanceof dt){s=a.value1,v=new Bt(a.value0.value0.value0,a.value0.value0.value1,a.value0.value0.value2,a.value0.value0.value3,a.value0.value1,a.value0.value2,A);return}return a.value0 instanceof mu&&a.value0.value2 instanceof Bt?(m=!0,wr(t)(a.value1)(new dt(new dt(A,a.value0.value0,a.value0.value1,a.value0.value2.value0),a.value0.value2.value1,a.value0.value2.value2,new dt(a.value0.value2.value3,a.value0.value2.value4,a.value0.value2.value5,a.value0.value2.value6)))):a.value0 instanceof Yn&&a.value0.value0 instanceof Bt?(m=!0,wr(t)(a.value1)(new dt(new dt(a.value0.value0.value0,a.value0.value0.value1,a.value0.value0.value2,a.value0.value0.value3),a.value0.value0.value4,a.value0.value0.value5,new dt(a.value0.value0.value6,a.value0.value1,a.value0.value2,A)))):a.value0 instanceof Du&&a.value0.value2 instanceof nt&&a.value0.value5 instanceof nt&&A instanceof nt?(m=!0,wr(t)(a.value1)(new Bt(nt.value,a.value0.value0,a.value0.value1,nt.value,a.value0.value3,a.value0.value4,nt.value))):a.value0 instanceof Mn&&a.value0.value0 instanceof nt&&a.value0.value5 instanceof nt&&A instanceof nt?(m=!0,wr(t)(a.value1)(new Bt(nt.value,a.value0.value1,a.value0.value2,nt.value,a.value0.value3,a.value0.value4,nt.value))):a.value0 instanceof bu&&a.value0.value0 instanceof nt&&a.value0.value3 instanceof nt&&A instanceof nt?(m=!0,wr(t)(a.value1)(new Bt(nt.value,a.value0.value1,a.value0.value2,nt.value,a.value0.value4,a.value0.value5,nt.value))):a.value0 instanceof Du&&a.value0.value2 instanceof dt?(m=!0,wr(t)(a.value1)(new dt(new Bt(A,a.value0.value0,a.value0.value1,a.value0.value2.value0,a.value0.value2.value1,a.value0.value2.value2,a.value0.value2.value3),a.value0.value3,a.value0.value4,a.value0.value5))):a.value0 instanceof Mn&&a.value0.value0 instanceof dt?(m=!0,wr(t)(a.value1)(new dt(new Bt(a.value0.value0.value0,a.value0.value0.value1,a.value0.value0.value2,a.value0.value0.value3,a.value0.value1,a.value0.value2,A),a.value0.value3,a.value0.value4,a.value0.value5))):a.value0 instanceof Mn&&a.value0.value5 instanceof dt?(m=!0,wr(t)(a.value1)(new dt(a.value0.value0,a.value0.value1,a.value0.value2,new Bt(A,a.value0.value3,a.value0.value4,a.value0.value5.value0,a.value0.value5.value1,a.value0.value5.value2,a.value0.value5.value3)))):a.value0 instanceof bu&&a.value0.value3 instanceof dt?(m=!0,wr(t)(a.value1)(new dt(a.value0.value0,a.value0.value1,a.value0.value2,new Bt(a.value0.value3.value0,a.value0.value3.value1,a.value0.value3.value2,a.value0.value3.value3,a.value0.value4,a.value0.value5,A)))):a.value0 instanceof Du&&a.value0.value2 instanceof Bt?(m=!0,wr(t)(a.value1)(new Bt(new dt(A,a.value0.value0,a.value0.value1,a.value0.value2.value0),a.value0.value2.value1,a.value0.value2.value2,new dt(a.value0.value2.value3,a.value0.value2.value4,a.value0.value2.value5,a.value0.value2.value6),a.value0.value3,a.value0.value4,a.value0.value5))):a.value0 instanceof Mn&&a.value0.value0 instanceof Bt?(m=!0,wr(t)(a.value1)(new Bt(new dt(a.value0.value0.value0,a.value0.value0.value1,a.value0.value0.value2,a.value0.value0.value3),a.value0.value0.value4,a.value0.value0.value5,new dt(a.value0.value0.value6,a.value0.value1,a.value0.value2,A),a.value0.value3,a.value0.value4,a.value0.value5))):a.value0 instanceof Mn&&a.value0.value5 instanceof Bt?(m=!0,wr(t)(a.value1)(new Bt(a.value0.value0,a.value0.value1,a.value0.value2,new dt(A,a.value0.value3,a.value0.value4,a.value0.value5.value0),a.value0.value5.value1,a.value0.value5.value2,new dt(a.value0.value5.value3,a.value0.value5.value4,a.value0.value5.value5,a.value0.value5.value6)))):a.value0 instanceof bu&&a.value0.value3 instanceof Bt?(m=!0,wr(t)(a.value1)(new Bt(a.value0.value0,a.value0.value1,a.value0.value2,new dt(a.value0.value3.value0,a.value0.value3.value1,a.value0.value3.value2,a.value0.value3.value3),a.value0.value3.value4,a.value0.value3.value5,new dt(a.value0.value3.value6,a.value0.value4,a.value0.value5,A)))):(m=!0,fn("The impossible happened in partial function `up`."))}throw new Error("Failed pattern match at Data.Map.Internal (line 552, column 5 - line 573, column 86): "+[a.constructor.name])}for(;!m;)b=D(s,v);return b}},n=function(l){return function(v){var s=l,m=!1,b;function D(a,A){if(A instanceof dt&&A.value0 instanceof nt&&A.value3 instanceof nt)return m=!0,e(a)(nt.value);if(A instanceof dt){s=new bt(new Yn(A.value0,A.value1,A.value2),a),v=A.value3;return}if(A instanceof Bt&&A.value0 instanceof nt&&A.value3 instanceof nt&&A.value6 instanceof nt)return m=!0,e(new bt(new Yn(nt.value,A.value1,A.value2),a))(nt.value);if(A instanceof Bt){s=new bt(new bu(A.value0,A.value1,A.value2,A.value3,A.value4,A.value5),a),v=A.value6;return}return m=!0,fn("The impossible happened in partial function `removeMaxNode`.")}for(;!m;)b=D(s,v);return b}},u=function(l){var v=!1,s;function m(b){if(b instanceof dt&&b.value3 instanceof nt)return v=!0,{key:b.value1,value:b.value2};if(b instanceof dt){l=b.value3;return}if(b instanceof Bt&&b.value6 instanceof nt)return v=!0,{key:b.value4,value:b.value5};if(b instanceof Bt){l=b.value6;return}return v=!0,fn("The impossible happened in partial function `maxNode`.")}for(;!v;)s=m(l);return s},o=Tt(t),c=function(l){return function(v){var s=l,m=!1,b;function D(a,A){if(A instanceof nt)return m=!0,w.value;if(A instanceof dt){var Q=o(r)(A.value1);if(A.value3 instanceof nt&&Q instanceof $t)return m=!0,new C(new H(A.value2,e(a)(nt.value)));if(Q instanceof $t){var Pt=u(A.value0);return m=!0,new C(new H(A.value2,n(new bt(new mu(Pt.key,Pt.value,A.value3),a))(A.value0)))}if(Q instanceof gt){s=new bt(new mu(A.value1,A.value2,A.value3),a),v=A.value0;return}s=new bt(new Yn(A.value0,A.value1,A.value2),a),v=A.value3;return}if(A instanceof Bt){var tr=function(){return A.value0 instanceof nt&&A.value3 instanceof nt&&A.value6 instanceof nt}(),Q=o(r)(A.value4),zt=o(r)(A.value1);if(tr&&zt instanceof $t)return m=!0,new C(new H(A.value2,wr(t)(a)(new dt(nt.value,A.value4,A.value5,nt.value))));if(tr&&Q instanceof $t)return m=!0,new C(new H(A.value5,wr(t)(a)(new dt(nt.value,A.value1,A.value2,nt.value))));if(zt instanceof $t){var Pt=u(A.value0);return m=!0,new C(new H(A.value2,n(new bt(new Du(Pt.key,Pt.value,A.value3,A.value4,A.value5,A.value6),a))(A.value0)))}if(Q instanceof $t){var Pt=u(A.value3);return m=!0,new C(new H(A.value5,n(new bt(new Mn(A.value0,A.value1,A.value2,Pt.key,Pt.value,A.value6),a))(A.value3)))}if(zt instanceof gt){s=new bt(new Du(A.value1,A.value2,A.value3,A.value4,A.value5,A.value6),a),v=A.value0;return}if(zt instanceof Ft&&Q instanceof gt){s=new bt(new Mn(A.value0,A.value1,A.value2,A.value4,A.value5,A.value6),a),v=A.value3;return}s=new bt(new bu(A.value0,A.value1,A.value2,A.value3,A.value4,A.value5),a),v=A.value6;return}throw new Error("Failed pattern match at Data.Map.Internal (line 525, column 16 - line 548, column 80): "+[A.constructor.name])}for(;!m;)b=D(s,v);return b}};return c(br.value)}},ve={foldr:function(t){return function(r){return function(e){if(e instanceof nt)return r;if(e instanceof dt)return er(ve)(t)(t(e.value2)(er(ve)(t)(r)(e.value3)))(e.value0);if(e instanceof Bt)return er(ve)(t)(t(e.value2)(er(ve)(t)(t(e.value5)(er(ve)(t)(r)(e.value6)))(e.value3)))(e.value0);throw new Error("Failed pattern match at Data.Map.Internal (line 133, column 17 - line 136, column 85): "+[e.constructor.name])}}},foldl:function(t){return function(r){return function(e){if(e instanceof nt)return r;if(e instanceof dt)return nr(ve)(t)(t(nr(ve)(t)(r)(e.value0))(e.value2))(e.value3);if(e instanceof Bt)return nr(ve)(t)(t(nr(ve)(t)(t(nr(ve)(t)(r)(e.value0))(e.value2))(e.value3))(e.value5))(e.value6);throw new Error("Failed pattern match at Data.Map.Internal (line 137, column 17 - line 140, column 85): "+[e.constructor.name])}}},foldMap:function(t){return function(r){return function(e){if(e instanceof nt)return xt(t);if(e instanceof dt)return W(t.Semigroup0())(xr(ve)(t)(r)(e.value0))(W(t.Semigroup0())(r(e.value2))(xr(ve)(t)(r)(e.value3)));if(e instanceof Bt)return W(t.Semigroup0())(xr(ve)(t)(r)(e.value0))(W(t.Semigroup0())(r(e.value2))(W(t.Semigroup0())(xr(ve)(t)(r)(e.value3))(W(t.Semigroup0())(r(e.value5))(xr(ve)(t)(r)(e.value6)))));throw new Error("Failed pattern match at Data.Map.Internal (line 141, column 17 - line 144, column 93): "+[e.constructor.name])}}}},Xr={foldrWithIndex:function(t){return function(r){return function(e){if(e instanceof nt)return r;if(e instanceof dt)return Tn(Xr)(t)(t(e.value1)(e.value2)(Tn(Xr)(t)(r)(e.value3)))(e.value0);if(e instanceof Bt)return Tn(Xr)(t)(t(e.value1)(e.value2)(Tn(Xr)(t)(t(e.value4)(e.value5)(Tn(Xr)(t)(r)(e.value6)))(e.value3)))(e.value0);throw new Error("Failed pattern match at Data.Map.Internal (line 147, column 26 - line 150, column 120): "+[e.constructor.name])}}},foldlWithIndex:function(t){return function(r){return function(e){if(e instanceof nt)return r;if(e instanceof dt)return Ye(Xr)(t)(t(e.value1)(Ye(Xr)(t)(r)(e.value0))(e.value2))(e.value3);if(e instanceof Bt)return Ye(Xr)(t)(t(e.value4)(Ye(Xr)(t)(t(e.value1)(Ye(Xr)(t)(r)(e.value0))(e.value2))(e.value3))(e.value5))(e.value6);throw new Error("Failed pattern match at Data.Map.Internal (line 151, column 26 - line 154, column 120): "+[e.constructor.name])}}},foldMapWithIndex:function(t){return function(r){return function(e){if(e instanceof nt)return xt(t);if(e instanceof dt)return W(t.Semigroup0())(Gn(Xr)(t)(r)(e.value0))(W(t.Semigroup0())(r(e.value1)(e.value2))(Gn(Xr)(t)(r)(e.value3)));if(e instanceof Bt)return W(t.Semigroup0())(Gn(Xr)(t)(r)(e.value0))(W(t.Semigroup0())(r(e.value1)(e.value2))(W(t.Semigroup0())(Gn(Xr)(t)(r)(e.value3))(W(t.Semigroup0())(r(e.value4)(e.value5))(Gn(Xr)(t)(r)(e.value6)))));throw new Error("Failed pattern match at Data.Map.Internal (line 155, column 26 - line 158, column 128): "+[e.constructor.name])}}},Foldable0:function(){return ve}},nv=function(){return Tn(Xr)(function(t){return function(r){return function(e){return new bt(t,e)}}})(br.value)}();var xn=function(){return nt.value}();var Jc=function(t){return function(r){return function(e){return Qt(e)(Jr)(ay(t)(r)(e))}}};var wn=function(t){return function(r){return function(e){return function(n){var u=r(Ca(t)(e)(n));if(u instanceof w)return Jc(t)(e)(n);if(u instanceof C)return Vi(t)(e)(u.value0)(n);throw new Error("Failed pattern match at Data.Map.Internal (line 596, column 15 - line 598, column 25): "+[u.constructor.name])}}}};var oy=function(t){return function(r){return function(e){return function(n){var u=function(o){return function(c){return function(l){return wn(t)(function(){var v=Qt(l)(r(l));return function(s){return C.create(v(s))}}())(o)(c)}}};return Ye(Xr)(u)(n)(e)}}}};var uv=function(t){return oy(t)(g)};var av={compact:function(t){return function(){var e=$n(),n=Ri(function(u){return Uu(t)(u)})();return Ni(n)(function(){var u=at(yr);return function(o){return u(function(c){if(c instanceof w)return p(se)(0);if(c instanceof C)return tn(c.value0)(e);throw new Error("Failed pattern match at Data.Compactable (line 111, column 34 - line 113, column 35): "+[c.constructor.name])}(o))}}())(),Fn(e)()}()},separate:function(t){return function(){var e=$n(),n=$n(),u=Ri(function(o){return Uu(t)(o)})();return Ni(u)(function(){var o=at(yr);return function(c){return o(function(l){if(l instanceof it)return tn(l.value0)(e);if(l instanceof et)return tn(l.value0)(n);throw new Error("Failed pattern match at Data.Compactable (line 122, column 34 - line 124, column 31): "+[l.constructor.name])}(c))}}())(),It(Fs)(k(yr)(function(o){return function(c){return{left:o,right:c}}})(Fn(e)))(Fn(n))()}()}};var zu=function(t){return t.compact};var ov={partitionMap:function(t){var r=function(e){return function(n){var u=t(n);if(u instanceof it)return{left:W(sr)(e.left)([u.value0]),right:e.right};if(u instanceof et)return{right:W(sr)(e.right)([u.value0]),left:e.left};throw new Error("Failed pattern match at Data.Filterable (line 149, column 16 - line 151, column 50): "+[u.constructor.name])}};return nr(ct)(r)({left:[],right:[]})},partition:Li,filterMap:Uc,filter:yo,Compactable0:function(){return av},Functor1:function(){return Ar}};var ye=function(t){return t.filterMap};var iv=function(t){return t.filter};var ge={dimap:function(t){return function(r){return function(e){return function(n){return r(e(t(n)))}}}}},fv=function(t){return t.dimap},Me=function(t){return function(r){return fv(t)(r)(kt(st))}};var vy=function(t){return function(r){return function(e){return uv(t)(r)(e)}}};var jc=function(t){return nv(t)};var lv=function(t){return ev(t)(void 0)};var Xc=function(t){return{append:vy(t)}};var pv={foldMap:function(t){return function(r){var e=xr(Ze)(t)(r);return function(n){return e(jc(n))}}},foldl:function(t){return function(r){var e=nr(Ze)(t)(r);return function(n){return e(jc(n))}}},foldr:function(t){return function(r){var e=er(Ze)(t)(r);return function(n){return e(jc(n))}}}};var my=xn;var _v=function(t){return{mempty:my,Semigroup0:function(){return Xc(t)}}};var sv=function(t){return function(r){return function(e){return Jc(t)(r)(e)}}};function vv(t){return function(r){return function(){return setTimeout(r,t)}}}function mv(t){return function(){clearTimeout(t)}}var Dv=vv;var dy={eq:function(t){return function(r){return t===r}}},ji={compare:function(t){return function(r){return Tt(de)(t)(r)}},Eq0:function(){return dy}};var bv=mv;var Vu=function(t){return t.keepLatest};var Au=function(t){return t.fold};var Ju=function(t){return function(r){return function(e){return function(n){return ye(t.Filterable1())(Jr)(Au(t)(function(u){return function(o){return k(Lu)(p(Vr))(r(u)(o.value0))}})(e)(new H(n,w.value)))}}}};function Gc(t){return function(r){return t===r}}var Qc=Gc;var Cy=function(t,r,e){var n=0,u;return function(o){if(n===2)return u;if(n===1)throw new ReferenceError(t+" was needed before it finished initializing (module "+r+", line "+o+")",r,o);return n=1,u=e(),n=2,u}},Ty=function(t){return t};var Sy=function(t){return function(r){return function(e){return function(n){return function(u){return L(t.Monad0().Bind1())(X(t)(kr(w.value)))(function(o){return L(t.Monad0().Bind1())(e(function(c){return X(t)(at(yr)(Or(new C(c))(o)))}))(function(c){return L(t.Monad0().Bind1())(n(function(l){return L(t.Monad0().Bind1())(X(t)(_r(o)))(Pe(r)(zr)(function(v){return u(l(v))}))}))(function(l){return p(r)(mt(r.Apply0())(c)(l))})})})}}}}},Zt={map:function(t){return function(r){return function(e){return r(function(n){return e(t(n))})}}}};var hy=function(t){return function(r){return function(e){return function(n){return function(u){return L(t.Monad0().Bind1())(X(t)(kr(n)))(function(o){return e(function(c){return L(t.Monad0().Bind1())(X(t)(Rr(r(c))(o)))(u)})})}}}}},So=function(t){return function(r){return function(e){return function(n){return e(function(u){var o=r(u);if(o instanceof C)return n(o.value0);if(o instanceof w)return p(t)(void 0);throw new Error("Failed pattern match at FRP.Event (line 185, column 13 - line 187, column 27): "+[o.constructor.name])})}}}},Yc=function(t){return function(r){return So(t)(function(e){var n=r(e);if(n)return new C(e);if(!n)return w.value;throw new Error("Failed pattern match at FRP.Event (line 113, column 13 - line 115, column 25): "+[n.constructor.name])})}},ho=function(t){return{compact:So(t)(kt(st)),separate:function(r){return{left:So(t)(function(e){if(e instanceof it)return new C(e.value0);if(e instanceof et)return w.value;throw new Error("Failed pattern match at FRP.Event (line 96, column 13 - line 98, column 33): "+[e.constructor.name])})(r),right:So(t)(function(e){if(e instanceof et)return new C(e.value0);if(e instanceof it)return w.value;throw new Error("Failed pattern match at FRP.Event (line 103, column 13 - line 105, column 32): "+[e.constructor.name])})(r)}}}},mn=function(t){return{filter:Yc(t),filterMap:So(t),partition:function(r){return function(e){return{yes:Yc(t)(r)(e),no:Yc(t)(function(){var n=Qe(_e);return function(u){return n(r(u))}}())(e)}}},partitionMap:function(r){return function(e){return{left:ye(mn(t))(function(){var n=Ge(C.create)(g(w.value));return function(u){return n(r(u))}}())(e),right:ye(mn(t))(function(n){return uc(r(n))})(e)}}},Compactable0:function(){return ho(t)},Functor1:function(){return Zt}}},Ey=function(t){return function(r){return function(e){return function(n){return function(u){return L(t.Monad0().Bind1())(X(t)(kr(w.value)))(function(o){return L(t.Monad0().Bind1())(X(t)($n))(function(c){return L(t.Monad0().Bind1())(X(t)(kr(w.value)))(function(l){return L(t.Monad0().Bind1())(X(t)($n))(function(v){return L(t.Monad0().Bind1())(X(t)(kr(!0)))(function(s){return L(t.Monad0().Bind1())(e(function(m){return L(t.Monad0().Bind1())(X(t)(_r(s)))(function(b){return b?X(t)(at(yr)(tn(m)(c))):L(t.Monad0().Bind1())(X(t)(Or(new C(m))(o)))(function(){return L(t.Monad0().Bind1())(X(t)(_r(l)))(Pe(r)(zr)(function(D){return u(D(m))}))})})}))(function(m){return L(t.Monad0().Bind1())(n(function(b){return L(t.Monad0().Bind1())(X(t)(_r(s)))(function(D){return D?X(t)(at(yr)(tn(b)(v))):L(t.Monad0().Bind1())(X(t)(Or(new C(b))(l)))(function(){return L(t.Monad0().Bind1())(X(t)(_r(o)))(Pe(r)(zr)(function(a){return u(b(a))}))})})}))(function(b){return L(t.Monad0().Bind1())(X(t)(Or(!1)(s)))(function(){return L(t.Monad0().Bind1())(X(t)(Oi(c)))(function(D){return L(t.Monad0().Bind1())(X(t)(Oi(v)))(function(a){return jt(Xt)(t.Monad0().Bind1())(function(){return D.length===0?at(r.Apply0().Functor0())(X(t)(Or(Bc(a))(l))):qr(r)(ct)(D)(function(A){return L(t.Monad0().Bind1())(X(t)(Or(new C(A))(o)))(function(){return qr(r)(ct)(a)(function(Q){return L(t.Monad0().Bind1())(X(t)(Or(new C(Q))(l)))(function(){return u(Q(A))})})})})}())(function(){return L(t.Monad0().Bind1())(X(t)(Pi(0)(En(D))([])(c)))(function(){return L(t.Monad0().Bind1())(X(t)(Pi(0)(En(a))([])(v)))(function(){return p(r)(mt(r.Apply0())(m)(b))})})})})})})})})})})})})})}}}}},Nr=function(t){return function(r){return r}(Gi(273).subscribe)(t)},ne=function(t){return function(r){return r}(Gi(296).makeEvent)(t)},Xi=function(t){return function(r){return jt(Xt)(t.Monad0().Bind1())(p(t.Monad0().Applicative0())(void 0))(function(){return function(e){return e(t)(r)}(Gi(312).create)})}},Gi=Cy("backdoor","FRP.Event",function(){return{makeEvent:Ty,create:function(){var t=function(r){return function(e){return L(r.Monad0().Bind1())(X(r)(kr([])))(function(n){return p(r.Monad0().Applicative0())({event:function(u){return L(e.Monad0().Bind1())(X(e)(Rr(function(o){return W(sr)(o)([u])})(n)))(function(){return p(e.Monad0().Applicative0())(L(e.Monad0().Bind1())(X(e)(Rr(Wi(Qc)(u))(n)))(function(){return p(e.Monad0().Applicative0())(void 0)}))})},push:function(u){return L(e.Monad0().Bind1())(X(e)(_r(n)))(Pe(e.Monad0().Applicative0())(ct)(function(o){return o(u)}))}})})}};return t}(),subscribe:function(){var t=function(r){return function(e){return r(e)}};return t}(),bus:function(){var t=function(r){return function(e){return ne(function(n){return L(r.Monad0().Bind1())(Xi(r)(r))(function(u){return jt(Xt)(r.Monad0().Bind1())(n(e(u.push)(u.event)))(function(){return p(r.Monad0().Applicative0())(p(r.Monad0().Applicative0())(void 0))})})})}};return t}(),memoize:function(){var t=function(r){return function(e){return function(n){return ne(function(u){return L(r.Monad0().Bind1())(Xi(r)(r))(function(o){return jt(Xt)(r.Monad0().Bind1())(u(n(o.event)))(function(){return Nr(e)(o.push)})})})}}};return t}(),hot:function(){var t=function(r){return function(e){return L(r.Monad0().Bind1())(Xi(r)(r))(function(n){return L(r.Monad0().Bind1())(Nr(e)(n.push))(function(u){return p(r.Monad0().Applicative0())({event:n.event,unsubscribe:u})})})}};return t}(),mailboxed:function(){var t=function(r){return function(e){return function(n){return function(u){return ne(function(o){return L(e.Monad0().Bind1())(X(e)(kr(xn)))(function(c){return jt(Xt)(e.Monad0().Bind1())(o(u(function(l){return ne(function(v){return jt(Xt)(e.Monad0().Bind1())(at(e.Monad0().Bind1().Apply0().Functor0())(X(e)(Rr(wn(r)(function(s){if(s instanceof w)return new C([v]);if(s instanceof C)return new C(W(sr)(s.value0)([v]));throw new Error("Failed pattern match at FRP.Event (line 494, column 21 - line 496, column 55): "+[s.constructor.name])})(l))(c))))(function(){return p(e.Monad0().Applicative0())(at(e.Monad0().Bind1().Apply0().Functor0())(X(e)(Rr(wn(r)(function(s){if(s instanceof w)return w.value;if(s instanceof C)return new C(Wi(Qc)(v)(s.value0));throw new Error("Failed pattern match at FRP.Event (line 503, column 21 - line 505, column 69): "+[s.constructor.name])})(l))(c))))})})})))(function(){return L(e.Monad0().Bind1())(Nr(n)(function(l){return L(e.Monad0().Bind1())(X(e)(_r(c)))(function(v){var s=Ca(r)(l.address)(v);if(s instanceof w)return p(e.Monad0().Applicative0())(void 0);if(s instanceof C)return qr(e.Monad0().Applicative0())(ct)(s.value0)(function(m){return m(l.payload)});throw new Error("Failed pattern match at FRP.Event (line 512, column 13 - line 514, column 49): "+[s.constructor.name])})}))(function(l){return p(e.Monad0().Applicative0())(jt(Xt)(e.Monad0().Bind1())(at(e.Monad0().Bind1().Apply0().Functor0())(X(e)(Or(xn)(c))))(function(){return l}))})})})})}}}};return t}(),delay:function(){var t=function(r){return function(e){return ne(function(n){return function(){var o=Wu(xt(_v(ji)))(),c=Nr(e)(function(l){return function(){var s=Wu(w.value)(),m=Dv(r)(function(){n(l)();var D=vu(s)();return Qt(p(ie)(void 0))(function(a){return wc(sv(ji)(a))(o)})(D)()})();return Ao(new C(m))(s)(),wc(W(Xc(ji))(lv(m)))(o)()}})();return function(){var v=vu(o)();return qr(ie)(pv)(v)(bv)(),c()}}})}};return t}()}}),dv=Gi(427),Zc=function(t){return function(r){return function(e){return e(t)}(dv.bus)(r)}};var Av=function(t){return function(r){return function(e){return e(t)}(dv.memoize)(r)}},$y=function(t){return function(r){return function(e){return function(n){return L(r.Bind1())(Xi(t)(t))(function(u){var o=e(u.event);return L(r.Bind1())(Nr(o.input)(u.push))(function(c){return L(r.Bind1())(Nr(o.output)(n))(function(l){return p(r.Applicative0())(mt(r.Bind1().Apply0())(c)(l))})})})}}}},Fy=function(t){return function(r){return function(e){return L(t.Monad0().Bind1())(X(t)(kr(w.value)))(function(n){return L(t.Monad0().Bind1())(r(function(u){return jt(Xt)(t.Monad0().Bind1())(L(t.Monad0().Bind1())(X(t)(_r(n)))(di(t.Monad0().Applicative0())(zr)))(function(){return L(t.Monad0().Bind1())(Nr(u)(e))(function(o){return X(t)(at(yr)(Or(new C(o))(n)))})})}))(function(u){return p(t.Monad0().Applicative0())(jt(Xt)(t.Monad0().Bind1())(L(t.Monad0().Bind1())(X(t)(_r(n)))(di(t.Monad0().Applicative0())(zr)))(function(){return u}))})})}}},My=function(t){return{apply:function(r){return function(e){return Ey(t)(t.Monad0().Applicative0())(r)(k(Zt)(Za)(e))}},Functor0:function(){return Zt}}};var j=function(t){return{pure:function(r){return function(e){return ei(t.Monad0().Bind1().Apply0().Functor0())(p(t.Monad0().Applicative0())(void 0))(e(r))}},Apply0:function(){return My(t)}}};var Vt=function(t){return{alt:function(r){return function(e){return function(n){return It(t.Apply0())(k(t.Apply0().Functor0())(function(u){return function(o){return mt(t.Apply0())(u)(o)}})(r(n)))(e(n))}}},Functor0:function(){return Zt}}};var d=function(t){return{empty:function(r){return p(t)(p(t)(void 0))},Alt0:function(){return Vt(t)}}},xy=function(t){return{Applicative0:function(){return j(t)},Plus1:function(){return d(t.Monad0().Applicative0())}}},me=function(t){return{fold:hy(t),keepLatest:Fy(t),sampleOn:Sy(t)(t.Monad0().Applicative0()),fix:$y(t)(t.Monad0()),Alternative0:function(){return xy(t)},Filterable1:function(){return mn(t.Monad0().Applicative0())}}};var kv="_____$__$_$$_vbus";function yv(t){return()=>{for(let r in t)delete t[r]}}function gv(t){return()=>{let r=(o,c,l,v)=>{let s=Object.keys(v);for(var m=0;m<s.length;m++)if(v[s[m]]instanceof Object&&v[s[m]][kv]===kv){let b={},D={};r(o,b,D,v[s[m]]),c[s[m]]=b,l[s[m]]=D}else{let b=`${Math.random()}`;o[b]={},c[s[m]]=D=>()=>{let a=Object.values(o[b]);for(var A=0;A<a.length;A++)a[A](D)()},l[s[m]]=D=>()=>{let a=`${Math.random()}`;return o[b][a]=D,()=>{o[b]&&o[b][a]&&delete o[b][a]}}}},e={},n={},u={};return r(e,n,u,t),{p:n,e:u,s:e}}}var Kc=function(t){return function(){return function(){return function(r){return function(e){return function(n){return Un(Ur(t)(r))(e)(n)}}}}}},tl=function(t){return function(){return function(r){return function(e){return he(Ur(t)(r))(e)}}}};var Qi={vb:function(t){return function(r){return function(e){return{}}}}},Cv=function(t){return t.vb},Iy={vbus:function(){var t=function(){return function(e){return function(n){return function(u){return function(o){var c=Cv(n)(z.value)(z.value)(z.value);return ne(function(l){return L(e.Monad0().Bind1())(gv(c))(function(v){return jt(Xt)(e.Monad0().Bind1())(l(o(v.p)(v.e)))(function(){return p(e.Monad0().Applicative0())(yv(v.s))})})})}}}}},r=function(){return function(e){return function(n){return t()(e)(n)}}};return r}()},el=function(){return function(t){return function(r){return function(e){return function(n){return n()(t)(r)}(Iy.vbus)(e)}}}};var Sa=function(t){return function(){return function(){return function(r){return function(){return function(){return function(){return function(){return{vb:function(e){return function(n){return function(u){return Kc(t)()()(z.value)(void 0)(Cv(r)(z.value)(z.value)(z.value))}}}}}}}}}}}};var ku=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),nl=function(){function t(){}return t.value=new t,t}();var Eo=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),$o=function(){function t(){}return t.value=new t,t}(),Zi=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),Ki=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),tf=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),ha=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),T=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}();var Ea={eq:function(t){return function(r){return t instanceof ku&&r instanceof ku?t.value0===r.value0:t instanceof nl&&r instanceof nl}}};var F=function(t){return new tf(t)};var Tv=function(t){return new Ki(t)};var rf={Always0:function(){return ua(ln(Xe))},Always1:function(){return ua(ln(ln(Xe)))},Always2:function(){return ua(ln(Xe))},Always3:function(){return ua(Ou(st))},Always4:function(){return ua(Ou(st))},MonadST5:function(){return Ms}},ef={Always0:function(){return aa(ln(Xe))},Always1:function(){return aa(ln(ln(Xe)))},Always2:function(){return aa(ln(Xe))},Always3:function(){return aa(Ou(st))},Always4:function(){return aa(Ou(st))},MonadST5:function(){return xs}},nf=function(){return function(t){return function(){return function(r){return function(e){return function(n){return function(u){return new ha(el()(t.MonadST5())(e)(n)(Me(ge)(Ds(vs()(r))(z.value))(u)))}}}}}}};var Sv=function(){return new Zi(0)}();var ul=function(){return $o.value}(),Xu=function(){return Eo.create}();var yu=function(t){return function(r){return function(e){return Zc(t.MonadST5())(Me(ge)(k(qe)(fo(r)))(e))}}};var $a=function(t){return function(r){return function(e){return new ha(yu(t)(r)(e))}}};var Ly=function(t){return t},Fo=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),Mo=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),Py=function(t){return t},uf=kn(),i=Py;var S=function(){return Fo.create}();var B=function(){return Mo.create}(),cr=function(){var t=k(qe)(k(O)(g(!0)));return function(r){return Ly(t(r))}}(),ut=function(t){return t.attr};function hv(t){return()=>t.slice()}function Ev(t){return r=>e=>()=>{e[t]=r}}function $v(t){return()=>t.slice()}var Fv=t=>r=>r[t];var Ln=function(t){return t.reflectType};var xv=function(t){return Ln(t)};var Fa=Ar;var af=function(){return function(t){return t}};var al=function(){return function(){return function(){return function(){return function(){return function(t){var r=xv(t);return function(e){return Fv(r(e))}}}}}}};var wv=[];var ol=function(){return function(){return function(t){return function(r){return go(t)(r)}}}};function Iv(t){return function(){var r={};for(var e in t)hasOwnProperty.call(t,e)&&(r[e]=t[e]);return r}}var gu={};function fl(t){return t()}function Lv(t){return function(r){return function(e){return function(n){var u=e;function o(l){return function(v){return r(v)(l)(n[l])}}for(var c in n)hasOwnProperty.call(n,c)&&(u=t(u)(o(c)));return u}}}}function of(t){return function(r){var e=[];for(var n in r)hasOwnProperty.call(r,n)&&e.push(t(n)(r[n]));return e}}var zy=Object.keys||of(function(t){return function(){return t}});function cl(t){return function(r){return function(e){return function(){return e[t]=r,e}}}}var ll=function(t){return function(r){return function(){return delete r[t],r}}};var Zy=of(function(t){return function(r){return r}});var Ky=Iv;var Pv=function(t){return function(r){return fl(function(){var n=Ky(r)();return t(n)(),n})}};var Ma=function(t){return function(r){return Pv(cl(t)(r))}};var Ov=Lv(Za),tg=function(t){return function(r){return Ov(function(e){return function(n){return function(u){return W(t.Semigroup0())(e)(r(n)(u))}}})(xt(t))}},Rv={foldl:function(t){return Ov(function(r){return function(e){return t(r)}})},foldr:function(t){return function(r){return function(e){return er(ct)(t)(r)(Zy(e))}}},foldMap:function(t){return function(r){return tg(t)(g(r))}}};var pl=function(t){return Pv(ll(t))};var Nv=function(){function t(){}return t.value=new t,t}(),sl=function(){function t(){}return t.value=new t,t}(),rg=function(){function t(){}return t.value=new t,t}();var Bv=function(t){return function(r){return function(e){var n=function(u){var o=function(c){return function(l){return new H(l+1|0,new H(c,l))}};return Ju(me(t))(o)(u)(0)};return new Ki(Vu(me(t))(Av(t)(n(e))(function(u){return k(Zt)(function(o){return ft(Vt(t.Monad0().Applicative0()))(p(j(t))(new Eo(r(o.value0))))(k(Zt)(g($o.value))(iv(mn(t.Monad0().Applicative0()))(function(){var c=Et(eo)(o.value1+1|0);return function(l){return c(Jr(l))}}())(u)))})(u)})))}}};var Pn=function(t){return function(r){return function(e){return function(n){return function(u){var o=function(c){return c(n)(u)};return function(c){if(c instanceof tf)return Dr(ct)(d(t))(Pn(t)(r)(e)(n)(u))(c.value0);if(c instanceof ha)return Vu(me(r))(k(Zt)(Pn(t)(r)(e)(n)(u))(c.value0));if(c instanceof T)return o(e.toElt(c.value0));if(c instanceof Ki)return ne(function(l){return L(r.Monad0().Bind1())(X(r)(kr(gu)))(function(v){return L(r.Monad0().Bind1())(Nr(c.value0)(function(s){return L(r.Monad0().Bind1())(e.ids(u))(function(m){return L(r.Monad0().Bind1())(X(r)(kr(p(t)(void 0))))(function(b){return L(r.Monad0().Bind1())(e.ids(u))(function(D){return L(r.Monad0().Bind1())(X(r)(kr(p(t)(void 0))))(function(a){return L(r.Monad0().Bind1())(X(r)(kr([])))(function(A){return L(r.Monad0().Bind1())(X(r)(kr(p(t)(void 0))))(function(Q){return L(r.Monad0().Bind1())(k(t.Apply0().Functor0())(ku.create)(e.ids(u)))(function(Pt){return L(r.Monad0().Bind1())(X(r)(kr(Nv.value)))(function(tr){return L(r.Monad0().Bind1())(Nr(s)(function(zt){return L(r.Monad0().Bind1())(X(r)(_r(tr)))(function(we){return zt instanceof Zi&&we instanceof sl?L(r.Monad0().Bind1())(X(r)(_r(A)))(Pe(t)(ct)(function(){var ae=e.doLogic(zt.value0)(u);return function(rt){return l(ae(rt))}}())):zt instanceof $o&&we instanceof sl?jt(Xt)(r.Monad0().Bind1())(at(t.Apply0().Functor0())(X(r)(Or(rg.value)(tr))))(function(){var ae=mt(t.Apply0())(mt(t.Apply0())(mt(t.Apply0())(mt(t.Apply0())(L(r.Monad0().Bind1())(X(r)(_r(A)))(Pe(t)(ct)(function(rt){return qr(t)(zr)(n.parent)(function(Zr){return l(e.disconnectElement(u)({id:rt,parent:Zr,scope:Pt}))})})))(wu(r.Monad0().Bind1())(X(r)(_r(b)))))(wu(r.Monad0().Bind1())(X(r)(_r(a)))))(at(t.Apply0().Functor0())(X(r)(Rr(pl(m))(v)))))(at(t.Apply0().Functor0())(X(r)(Rr(pl(D))(v))));return mt(t.Apply0())(at(t.Apply0().Functor0())(X(r)(Or(ae)(Q))))(ae)}):zt instanceof Eo&&we instanceof Nv?jt(Xt)(r.Monad0().Bind1())(at(t.Apply0().Functor0())(X(r)(Or(sl.value)(tr))))(function(){return L(r.Monad0().Bind1())(Nr(Pn(t)(r)(e)(function(){var ae={};for(var rt in n)({}).hasOwnProperty.call(n,rt)&&(ae[rt]=n[rt]);return ae.scope=Pt,ae.raiseId=function(Zr){return at(t.Apply0().Functor0())(X(r)(Rr(W(sr)([Zr]))(A)))},ae}())(u)(zt.value0))(l))(function(ae){return jt(Xt)(r.Monad0().Bind1())(at(t.Apply0().Functor0())(X(r)(Rr(Ma(D)(ae))(v))))(function(){return at(t.Apply0().Functor0())(X(r)(Or(ae)(a)))})})}):p(t)(void 0)})}))(function(zt){return jt(Xt)(r.Monad0().Bind1())(at(t.Apply0().Functor0())(X(r)(Or(zt)(b))))(function(){return jt(Xt)(r.Monad0().Bind1())(at(t.Apply0().Functor0())(X(r)(Rr(Ma(m)(zt))(v))))(function(){return wu(r.Monad0().Bind1())(X(r)(_r(Q)))})})})})})})})})})})})}))(function(s){return p(t)(jt(Xt)(r.Monad0().Bind1())(L(r.Monad0().Bind1())(X(r)(_r(v)))(nr(Rv)(mt(t.Apply0()))(p(t)(void 0))))(function(){return s}))})})});throw new Error("Failed pattern match at Bolson.Control (line 530, column 17 - line 614, column 20): "+[c.constructor.name])}}}}}},eg=function(){return function(t){return function(r){return function(e){return function(n){return function(u){return function(o){return function(c){var l=function(v){return function(s){return ne(function(m){return L(t.Monad0().Bind1())(hv(k(Ar)(g(""))(af()(o))))(function(b){var D=_a(ct)(d(t.Monad0().Applicative0()))(Xn(va)(function(a){return oc(M_)(function(A){return function(Q){return Q instanceof T?function(Pt){return Pt(function(){var tr={};for(var zt in v)({}).hasOwnProperty.call(v,zt)&&(tr[zt]=v[zt]);return tr.parent=w.value,tr.scope=e(v.scope),tr.raiseId=function(we){return Ev(a)(we)(b)},tr}())(s)}(u.toElt(Q.value0)):A(u.wrapElt(Q))}})})(af()(o)));return L(t.Monad0().Bind1())(Nr(D)(m))(function(a){return L(t.Monad0().Bind1())(X(t)(kr(p(t.Monad0().Applicative0())(void 0))))(function(A){return L(t.Monad0().Bind1())(k(t.Monad0().Bind1().Apply0().Functor0())(q)($v(b)))(function(Q){var Pt=k(Fa)(function(zt){return function(we){return new T(u.fromEltO1(function(ae){return function(rt){return ne(function(Zr){return jt(Xt)(t.Monad0().Bind1())(ae.raiseId(zt))(function(){return jt(Xt)(t.Monad0().Bind1())(qr(t.Monad0().Applicative0())(zr)(ae.parent)(function(Ga){return Zr(u.giveNewParent(rt)({id:zt,parent:Ga,scope:ae.scope})(we))}))(function(){return p(t.Monad0().Applicative0())(p(t.Monad0().Applicative0())(void 0))})})})}}))}})(Q),tr=Pn(t.Monad0().Applicative0())(t)(n)(v)(s)(c(Pt)(q));return L(t.Monad0().Bind1())(Nr(tr)(m))(function(zt){return jt(Xt)(t.Monad0().Bind1())(at(t.Monad0().Bind1().Apply0().Functor0())(X(t)(Or(zt)(A))))(function(){return p(t.Monad0().Applicative0())(jt(Xt)(t.Monad0().Bind1())(a)(function(){return jt(Xt)(t.Monad0().Bind1())(Wn(t.Monad0().Applicative0())(!r)(qr(t.Monad0().Applicative0())(ct)(af()(Q))(function(we){return m(u.deleteFromCache(s)({id:we}))})))(function(){return wu(t.Monad0().Bind1())(X(t)(_r(A)))})}))})})})})})})})}};return new T(u.fromEltO2(l))}}}}}}}};var Hv=function(){return function(t){return function(r){return function(e){return function(n){return function(u){return eg()(t)(!1)(kt(st))(r)(e)(n)(u)}}}}}};var ng=function(t){return t.makeText},ug=function(t){return function(r){return function(e){return k(Zt)(function(n){return t.setText(function(u){return{id:r,text:u}}(n))})(e)}}},ag=function(t){return function(r){return function(e){return k(Zt)(function(n){return function(u){if(u.value instanceof Fo)return t.setProp({id:r,key:u.key,value:u.value.value0});if(u.value instanceof Mo)return t.setCb({id:r,key:u.key,value:u.value.value0});throw new Error("Failed pattern match at Deku.Control (line 87, column 26 - line 89, column 45): "+[u.value.constructor.name])}(uf(n))})(e)}}},og=function(t){return t.makeElement},ig=function(t){return t.attributeParent},Be=function(t){return function(r){var e=function(n){return function(u){return ne(function(o){return L(t.Monad0().Bind1())(u.ids)(function(c){return jt(Xt)(t.Monad0().Bind1())(n.raiseId(c))(function(){return k(t.Monad0().Bind1().Apply0().Functor0())(mt(t.Monad0().Bind1().Apply0())(o(u.deleteFromCache({id:c}))))(Nr(_a(ct)(d(t.Monad0().Applicative0()))([p(j(t))(ng(u)({id:c,parent:n.parent,scope:n.scope})),ug(u)(c)(r)]))(o))})})})}};return new T(e)}},qt=function(t){return function(r){return Be(t)(p(j(t))(r))}},ff=function(t){return function(r){return function(e){return function(n){return r(y(d(t.MonadST5().Monad0().Applicative0())))([Bv(t.MonadST5())(e)(n)])}}}};var Wv=function(t){return{doLogic:function(r){return function(e){return function(n){return e.sendToPos({id:n,pos:r})}}},ids:function(){var r=Er(t);return function(e){return function(n){return n.ids}(r(e))}}(),disconnectElement:function(r){return function(e){return r.disconnectElement({id:e.id,scope:e.scope,parent:e.parent,scopeEq:Et(Ea)})}},toElt:function(r){return r}}};var xa=function(t){return function(r){return function(e){return r(y(d(t.MonadST5().Monad0().Applicative0())))([Tv(e)])}}};var fg=function(t){return Pn(t.MonadST5().Monad0().Applicative0())(t.MonadST5())(Wv())};var M=function(t){return function(r){return function(e){return function(n){var u=function(o){return function(c){return ne(function(l){return L(t.MonadST5().Monad0().Bind1())(c.ids)(function(v){return jt(Xt)(t.MonadST5().Monad0().Bind1())(o.raiseId(v))(function(){return k(t.MonadST5().Monad0().Bind1().Apply0().Functor0())(function(s){return mt(t.MonadST5().Monad0().Bind1().Apply0())(l(c.deleteFromCache({id:v})))(s)})(Nr(ft(Vt(t.MonadST5().Monad0().Applicative0()))(_a(ct)(d(t.MonadST5().Monad0().Applicative0()))(W(sr)([p(j(t.MonadST5()))(og(c)({id:v,parent:o.parent,scope:o.scope,tag:r})),ag(c)(v)(e)])(Qt([])(function(s){return[p(j(t.MonadST5()))(ig(c)({id:v,parent:s,pos:o.pos}))]})(o.parent))))(fg(t)({parent:new C(v),scope:o.scope,raiseId:function(s){return p(t.MonadST5().Monad0().Applicative0())(void 0)},pos:w.value})(c)(n)))(l))})})})}};return u}}}};var Uv=function(){return function(t){return function(r){return function(e){return Hv()(t.MonadST5())(Wv())({fromEltO1:kn(),fromEltO2:kn(),toElt:kn(),wrapElt:function(){var n=M(t)("div")(y(d(t.MonadST5().Monad0().Applicative0())));return function(u){return T.create(n(u))}}(),giveNewParent:function(n){return function(u){return function(o){return Er()(n).giveNewParent(u)}}},deleteFromCache:function(){var n=Er();return function(u){return function(o){return o.deleteFromCache}(n(u))}}()})(r)(Me(ge)(k(Fa)(function(n){return n(void 0)}))(kn()(e)))}}}};var Ir=function(){function t(){}return t.value=new t,t}();var Br={attr:function(t){return function(r){return i({key:"href",value:S(r)})}}};var lr=function(){function t(){}return t.value=new t,t}(),wa={attr:function(t){return function(r){return i({key:"click",value:B(g(N(O)(r)(!0)))})}}};var gr={attr:function(t){return function(r){return i({key:"click",value:B(r)})}}};var fe=function(){function t(){}return t.value=new t,t}();var Ia={attr:function(t){return function(r){return i({key:"style",value:S(r)})}}};var qv={attr:function(t){return function(r){return i({key:"style",value:S(r)})}}};var zv={attr:function(t){return function(r){return i({key:"style",value:S(r)})}}};var ml={attr:function(t){return function(r){return i({key:"style",value:S(r)})}}};var cf={attr:function(t){return function(r){return i({key:"style",value:S(r)})}}};var Vv={attr:function(t){return function(r){return i({key:"style",value:S(r)})}}};var wo=function(t){return function(r){return function(e){return new T(M(t)("a")(r)(F(e)))}}};var en=function(t){return function(r){return function(e){return new T(M(t)("div")(r)(F(e)))}}},Kt=function(t){return en(t)(y(d(t.MonadST5().Monad0().Applicative0())))};var Rn=function(t){return function(r){return function(e){return new T(M(t)("span")(r)(F(e)))}}},Dl=function(t){return Rn(t)(y(d(t.MonadST5().Monad0().Applicative0())))};var Gu=function(){function t(){}return t.value=new t,t}();var jv={attr:function(t){return function(r){return i({key:"type",value:S(r)})}}};var pf={attr:function(t){return function(r){return i({key:"type",value:S(r)})}}};var De=function(t){return function(r){return function(e){return new T(M(t)("button")(r)(F(e)))}}},dl=function(t){return De(t)(y(d(t.MonadST5().Monad0().Applicative0())))};var Xv=function(t){return function(r){return function(e){return new T(M(t)("code")(r)(F(e)))}}},$r=function(t){return Xv(t)(y(d(t.MonadST5().Monad0().Applicative0())))};var Gv=function(t){return function(r){return function(e){return new T(M(t)("i")(r)(F(e)))}}},Al=function(t){return Gv(t)(y(d(t.MonadST5().Monad0().Applicative0())))};var tu=function(t){return function(r){return function(e){return new T(M(t)("input")(r)(F(e)))}}};var Qv=function(t){return function(r){return function(e){return new T(M(t)("li")(r)(F(e)))}}},kl=function(t){return Qv(t)(y(d(t.MonadST5().Monad0().Applicative0())))};var Yv=function(t){return function(r){return function(e){return new T(M(t)("pre")(r)(F(e)))}}},Fr=function(t){return Yv(t)(y(d(t.MonadST5().Monad0().Applicative0())))};var Zv=function(t){return function(r){return function(e){return new T(M(t)("ul")(r)(F(e)))}}},yl=function(t){return Zv(t)(y(d(t.MonadST5().Monad0().Applicative0())))};var sf=function(){function t(){}return t.value=new t,t}(),La=function(){function t(){}return t.value=new t,t}(),Pa=function(){function t(){}return t.value=new t,t}(),Oa=function(){function t(){}return t.value=new t,t}(),Ra=function(){function t(){}return t.value=new t,t}(),Na=function(){function t(){}return t.value=new t,t}(),Ba=function(){function t(){}return t.value=new t,t}(),Ha=function(){function t(){}return t.value=new t,t}(),Wa=function(){function t(){}return t.value=new t,t}(),Ua=function(){function t(){}return t.value=new t,t}(),Kv=function(t){return t==="Intro"?p(Vr)(sf.value):t==="HelloWorld"?p(Vr)(La.value):t==="SimpleComponent"?p(Vr)(Pa.value):t==="PURSX1"?p(Vr)(Oa.value):t==="PURSX2"?p(Vr)(Ra.value):t==="Events"?p(Vr)(Na.value):t==="Effects"?p(Vr)(Ba.value):t==="Events2"?p(Vr)(Ha.value):t==="Portals"?p(Vr)(Wa.value):t==="SSR"?p(Vr)(Ua.value):y(k_)};function gl(){window.scrollTo(0,0)}var ue=gl;var sg=function(t){return t};var Lr=function(t){return{pursxToElement:function(r){return function(e){return function(n){return{cache:gu,element:function(u){return function(o){return y(d(t))}}}}}}}},Cl=function(t){return t.pursxToElement},Gr=function(){return function(t){return function(r){return function(e){return function(n){return{pursxToElement:function(u){return function(o){return function(c){var l=Cl(t)(u)(z.value)(c);return{cache:Ma(Ln(r)(z.value))(!0)(l.cache),element:function(v){return function(s){return ft(Vt(n.MonadST5().Monad0().Applicative0()))(k(Zt)(Me(ge)(uf)(function(m){if(m.value instanceof Fo)return s.setProp({id:Ln(r)(z.value)+("@!%"+u),key:m.key,value:m.value.value0});if(m.value instanceof Mo)return s.setCb({id:Ln(r)(z.value)+("@!%"+u),key:m.key,value:m.value.value0});throw new Error("Failed pattern match at Deku.Pursx (line 4492, column 38 - line 4502, column 24): "+[m.value.constructor.name])}))(tl(e)()(z.value)(c)))(l.element(v)(s))}}}}}}}}}}}};var ur=sg,Tl=function(t){return function(r){return function(){return function(){return function(e){return function(n){return function(u){return function(o){return function(c){var l=function(v){return function(s){return ne(function(m){return L(e.MonadST5().Monad0().Bind1())(s.ids)(function(b){return L(e.MonadST5().Monad0().Bind1())(s.ids)(function(D){return jt(Xt)(e.MonadST5().Monad0().Bind1())(v.raiseId(b))(function(){var a=Cl(n)(D)(z.value)(c);return k(e.MonadST5().Monad0().Bind1().Apply0().Functor0())(mt(e.MonadST5().Monad0().Bind1().Apply0())(m(s.deleteFromCache({id:b}))))(Nr(ft(Vt(e.MonadST5().Monad0().Applicative0()))(p(j(e.MonadST5()))(s.makePursx({id:b,parent:v.parent,cache:a.cache,pxScope:D,scope:v.scope,html:Ln(t)(o),verb:Ln(r)(u)})))(a.element(v)(s)))(m))})})})})}};return new T(l)}}}}}}}}},Hr=function(t){return function(){return function(){return function(r){return function(e){return Tl(t)({reflectType:function(){return"~"}})()()(e)(r)(z.value)}}}}},tm=function(t){return function(){return function(r){return function(e){return function(n){return Hr(t)()()(e)(r)(n)({})}}}}},vg=function(t){return Pn(t.MonadST5().Monad0().Applicative0())(t.MonadST5())({doLogic:function(r){return function(e){return function(n){return e.sendToPos({id:n,pos:r})}}},ids:function(){var r=Er();return function(e){return function(n){return n.ids}(r(e))}}(),disconnectElement:function(r){return function(e){return r.disconnectElement({id:e.id,scope:e.scope,parent:e.parent,scopeEq:Et(Ea)})}},toElt:function(r){return r}})},ar=function(){return function(t){return function(r){return function(e){return function(n){return{pursxToElement:function(u){return function(o){return function(c){var l=tl(e)()(z.value)(c),v=Cl(t)(u)(z.value)(c);return{cache:Ma(Ln(r)(z.value))(!1)(v.cache),element:function(s){return function(m){return ft(Vt(n.MonadST5().Monad0().Applicative0()))(vg(n)({parent:new C(Ln(r)(z.value)+("@!%"+u)),scope:s.scope,raiseId:function(b){return p(n.MonadST5().Monad0().Applicative0())(void 0)},pos:s.pos})(m)(l))(v.element(s)(m))}}}}}}}}}}}};var Sl=`module Main where

import Prelude

import Control.Alt ((<|>))
import Data.Compactable (compact)
import Data.Maybe (Maybe(..))
import Deku.Attribute ((:=))
import Deku.Control (text)
import Deku.DOM as D
import Deku.Pursx (nut, (~~))
import Deku.Toplevel (runInBody1)
import Effect (Effect)
import FRP.Event (bus)
import Type.Proxy (Proxy(..))

myDom =
  Proxy
    :: Proxy
         """<div>
        <button>I do nothing</button>
        <ul>
          <li>A</li>
          <li ~myli~>B</li>
          <li>C</li>
        </ul>
        <div>
          <a href="https://github.com/mikesol/purescript-deku"></a>
          <i>bar</i>
          ~somethingNew~
          <span style="font-weight:800;">baz</span>
        </div>
        <div><div></div><div><input type="range"/></div></div>
      </div>
"""

main :: Effect Unit
main = runInBody1
  ( bus \\push event -> myDom ~~
      { myli: pure (D.Style := "background-color:rgb(200,240,210);")
      , somethingNew: nut
          ( D.button (pure (D.OnClick := push (Just unit)))
              [ text
                  $ (compact event $> "Thanks for clicking me!") <|>
                      pure "I was dynamically inserted"
              ]
          )
      }
  )`,hl=`module Main where

import Prelude

import Deku.Pursx (psx)
import Deku.Toplevel (runInBody)
import Effect (Effect)
import Type.Proxy (Proxy(..))

myDom =
  Proxy
    :: Proxy
         """<div>
    <button>I do nothing</button>
    <ul>
        <li>A</li>
        <li>B</li>
        <li>C</li>
    </ul>
    <div>
        <a href="https://github.com/mikesol/purescript-deku"></a>
        <i>bar</i>
        <span style="font-weight:800;">baz</span>
    </div>
    <div><div></div><div><input type="range"/></div></div>
    </div>
"""

main :: Effect Unit
main = runInBody (psx myDom)`,El=`module Main where

import Prelude

import Control.Alt ((<|>))
import Data.FastVect.FastVect (index, (:))
import Data.FastVect.FastVect as V
import Data.Foldable (oneOfMap)
import Data.Profunctor (lcmap)
import Deku.Attribute ((:=))
import Deku.Control (portal, switcher_, text_)
import Deku.Core (Domable)
import Deku.DOM as D
import Deku.Toplevel (runInBody1)
import Effect (Effect)
import FRP.Event (AnEvent, bus, fold)
import Type.Prelude (Proxy(..))

main :: Effect Unit
main = runInBody1
  ( bus \\push -> lcmap (pure unit <|> _) \\event -> do
      portal
        ( map
            ( \\i -> D.video
                (oneOfMap pure [ D.Controls := "true", D.Width := "250" ])
                [ D.source
                    (oneOfMap pure [ D.Src := i, D.Xtype := "video/mp4" ])
                    []
                ]
            )
            ( "https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4"
                : "https://www.w3schools.com/jsref/movie.mp4"
                : V.empty
            )
        )
        \\v _ -> do
          let
            p0 :: Domable _ _ _
            p0 = index (Proxy :: _ 0) v
            p1 :: Domable _ _ _
            p1 = index (Proxy :: _ 1) v
            ev :: Boolean -> AnEvent _ Boolean
            ev = fold (const not) event
            flips :: Boolean -> Domable _ _ _
            flips = switcher_ D.span (if _ then p0 else p1) <<< ev
          D.div_
            [ D.button (pure $ D.OnClick := push unit)
                [ text_ "Switch videos" ]
            , D.div_ [ D.span_ [ flips true ], flips false ]
            ]
  )
`,$l=`module Main where

import Prelude

import Deku.Control (text_)
import Deku.Toplevel (runInBody)
import Effect (Effect)

main :: Effect Unit
main = runInBody (text_ "Hello world")`,Fl=`module Main where

import Prelude

import Control.Alt ((<|>))
import Data.Filterable (compact)
import Data.Foldable (oneOf)
import Data.Maybe (Maybe(..))
import Data.Tuple.Nested ((/\\))
import Deku.Control (dyn_, text_)
import Deku.Core (Nut, bussed, insert_, remove, sendToTop)
import Deku.DOM as D
import Deku.Listeners (click, keyUp, textInput)
import Deku.Toplevel (runInBody)
import Effect (Effect)
import FRP.Event (AnEvent, bus, keepLatest, mapAccum)
import Web.UIEvent.KeyboardEvent (code)

data MainUIAction
  = AddTodo
  | ChangeText String

data TodoAction = Prioritize | Delete

main :: Effect Unit
main = runInBody
  ( bussed \\pushAction actionEvent -> do
      let
        accumulateTextAndEmitOnSubmit :: AnEvent _ String
        accumulateTextAndEmitOnSubmit = compact
          ( mapAccum
              ( \\a b -> case a of
                  AddTodo -> b /\\ Just b
                  ChangeText s -> s /\\ Nothing
              )
              actionEvent
              ""
          )

        top :: Nut
        top =
          D.div_
            [ D.input
                ( oneOf
                    [ textInput $ pure (pushAction <<< ChangeText)
                    , keyUp $ pure \\evt -> do
                        when (code evt == "Enter") $ do
                          pushAction AddTodo
                    ]
                )
                []
            , D.button
                (click $ pure $ pushAction AddTodo)
                [ text_ "Add" ]
            ]
      D.div_
        [ top
        , dyn_ D.div $
            map
              ( \\txt -> keepLatest $ bus \\p' e' ->
                  ( pure $ insert_ $ D.div_
                      [ text_ txt
                      , D.button
                          (click $ pure (p' sendToTop))
                          [ text_ "Prioritize" ]
                      , D.button
                          (click $ pure (p' remove))
                          [ text_ "Delete" ]
                      ]
                  ) <|> e'
              )
              accumulateTextAndEmitOnSubmit
        ]
  )
`,Ml=`module Main where

import Prelude

import Bolson.Core (vbussed)
import Control.Alt ((<|>))
import Deku.Control (text, text_)
import Deku.DOM as D
import Deku.Listeners (click_, slider)
import Deku.Toplevel (runInBody)
import Effect (Effect)
import FRP.Event (AnEvent, fold)
import FRP.Event.VBus (V)
import Type.Proxy (Proxy(..))

type UIEvents = V
  ( buttonClicked :: Unit
  , sliderMoved :: Number
  )

main :: Effect Unit
main = runInBody
  ( vbussed (Proxy :: _ UIEvents) \\push event -> do
      let
        countUp :: AnEvent _ Int
        countUp = fold
          (const (1 + _))
          (pure unit <|> event.buttonClicked)
          (-1)
      D.div_
        [ D.button
            (click_ (pure push.buttonClicked))
            [ text_ "Click" ]
        , D.div_
            [ text
                ( pure "Val: 0" <|>
                    ( append "Val: " <<< show <$> countUp
                    )
                )
            ]
        , D.div_
            [ D.input
                (slider (pure push.sliderMoved))
                []
            , D.div_
                [ text
                    ( pure "Val: 50" <|>
                        ( append "Val: " <<< show
                            <$> event.sliderMoved
                        )
                    )
                ]
            ]
        ]
  )
`,xl=`module Main where

import Prelude

import Affjax.ResponseFormat as ResponseFormat
import Affjax.Web as AX
import Control.Alt ((<|>))
import Data.Argonaut.Core (stringifyWithIndent)
import Data.Either (Either(..))
import Data.Filterable (compact, separate)
import Data.HTTP.Method (Method(..))
import Data.Maybe (Maybe(..))
import Data.Profunctor (lcmap)
import Data.Tuple.Nested ((/\\))
import Deku.Attribute (Cb, cb, (:=))
import Deku.Control (text)
import Deku.DOM as D
import Deku.Toplevel (runInBody1)
import Effect (Effect)
import Effect.Aff (launchAff_)
import Effect.Class (liftEffect)
import FRP.Event (AnEvent, bus, mapAccum)

data UIAction = Initial | Loading | Result String

clickCb :: (UIAction -> Effect Unit) -> Cb
clickCb push = cb
  ( const do
      push Loading
      launchAff_ $ do
        result <- AX.request
          ( AX.defaultRequest
              { url = "https://randomuser.me/api/"
              , method = Left GET
              , responseFormat = ResponseFormat.json
              }
          )
        case result of
          Left err -> liftEffect $ push
            $ Result
                ( "GET /api response failed to decode: " <>
                    AX.printError err
                )
          Right response -> liftEffect $ push $ Result $
            stringifyWithIndent 2 response.body
  )

clickText = "Click to get some random user data." :: String

main :: Effect Unit
main = runInBody1
  ( bus \\push -> lcmap (pure Initial <|> _)
      \\event -> do
        let
          split :: { left :: AnEvent _ Unit, right :: AnEvent _ String }
          split = separate $ compact $
            map
              ( case _ of
                  Loading -> Just $ Left unit
                  Result s -> Just $ Right s
                  _ -> Nothing
              )
              event
          { left: loading, right: result } = split
        D.div_
            [ D.div_
                [ D.button (pure (D.OnClick := clickCb push))
                    [ text
                        ( pure clickText
                            <|> (loading $> "Loading...")
                            <|> (result $> clickText)
                        )
                    ]
                ]
            , D.div
                ( (pure (D.Style := "display: none;")) <|>
                    ( compact
                        ( mapAccum
                            ( \\_ b -> (b && false) /\\
                                if b then Just unit else Nothing
                            )
                            result
                            true
                        ) $> (D.Style := "display: block;")
                    )
                )
                [ D.pre_ [ D.code_ [ text (pure "" <|> result) ] ] ]
            ]
  )
`,wl=`module Main where

import Prelude

import Deku.Attribute ((:=))
import Deku.Control (text_)
import Deku.DOM as D
import Deku.Toplevel (runInBodyA)
import Effect (Effect)

main :: Effect Unit
main = runInBodyA
  ( [ D.button_ [ text_ "I do nothing" ]
    , D.ul_ $ map (D.li_ <<< pure <<< text_) [ "A", "B", "C" ]
    , D.div_
        [ D.a (pure $ D.Href := "https://example.com")
            [ text_ "foo " ]
        , D.i_ [ text_ " bar " ]
        , D.span (pure $ D.Style := "font-weight: 800;")
            [ text_ " baz" ]
        ]
    , D.div_
        [ D.div_
            [ D.div_ [ D.input (pure $ D.Xtype := "range") [] ]
            ]
        ]
    ]
  )`,Il=`module Main where

import Prelude

import Control.Alt ((<|>))
import Deku.Control (text, text_)
import Deku.DOM as D
import Deku.Listeners (click_, slider)
import Deku.Core (Nut, vbussed)
import FRP.Event (fold)
import FRP.Event.VBus (V)
import Type.Proxy (Proxy(..))

type UIEvents = V
  ( buttonClicked :: Unit
  , sliderMoved :: Number
  )

app :: Nut
app = vbussed (Proxy :: _ UIEvents) \\push event -> do
  D.div_
    [ D.p_
        [ text_
            """Here's an example of SSR in deku.
All of the static bits are rendered as HTML,
and all of the dynamic bits are hydrated on page load."""
        ]
    , D.button
        (click_ (pure push.buttonClicked))
        [ text_ "Click" ]
    , D.div_
        [ text
            ( pure "Val: 0" <|>
                ( append "Val: " <<< show
                    <$> fold
                      (const (add 1))
                      (pure unit <|> event.buttonClicked)
                      (-1)
                )
            )
        ]
    , D.div_
        [ D.input
            (slider (pure push.sliderMoved))
            []
        , D.div_
            [ text
                ( pure "Val: 50" <|>
                    ( map
                        (append "Val: " <<< show)
                        event.sliderMoved
                    )
                )
            ]
        ]
    ]
`,Ll=`module Deku.Example.Docs.Examples.SSR.Build where

import Prelude

import Deku.Examples.Docs.Examples.SSR.App (app)
import Deku.Toplevel (Template(..), runSSR)
import Effect (Effect)
import Effect.Console (log)

main :: Effect Unit
main =
  runSSR
    ( Template
        { head:
            """<!DOCTYPE html>
<html>
  <head>
    <title>My static page</title>
		<script src="bundle.js" defer><\/script>
  </head>"""
        , tail: "</html>"
        }
    )
    app >>= log`,Pl=`module Deku.Example.Docs.Examples.SSR.Live where

import Prelude

import Deku.Examples.Docs.Examples.SSR.App (app)
import Deku.Toplevel (hydrate)
import Effect (Effect)

main :: Effect Unit
main = hydrate app`;function rm(t){return t.target}function Wr(t){return function(){return t.preventDefault()}}function em(t,r,e){return t==null?r:e(t)}function Ol(t){return t}var qa=Qt(null)(Ol),Qr=function(t){return em(t,w.value,C.create)};var Df=function(t){return Qr(rm(t))};var dg=function(){return z.value}(),um=function(t){return function(r){return Hr({reflectType:function(){return`<div>
  <h1>A Simple Component</h1>

  <h3>Slightly more bells and whistles</h3>
  <p>
    Let's look at an example with several different DOM tags.
  </p>

  ~code~

  <p>And here's what it produces:</p>

  <blockquote> ~result~ </blockquote>

  <h1>Creating an element</h1>
  <p>To create an element, like for example a <code>span</code> element, the pattern goes like this:</p>

  <pre><code>mySpanWithAttrs = D.span attrs children
mySpanWithNoAttrs = D.span_ children
myDivWithNoChildren = D.div attrs blank
</code></pre>

  <p><code>attrs</code> contains attributes of type <code>Event (Attribute element)</code>, where <code>element</code> is the current element you're assigning attributes to. You never have to specify this type: it is inferred automatically by the attribute creation operator, aka <code>:=</code>. If you use an attribute that's unsupported by an element, the compiler will complain.</p>

  <p>For now, children is an array of children, not unlike Halogen or React sans JSX. We'll see some other types of children later in this guide.</p>

  <h1>Attributes</h1>
  <p>Attributes like an element's style or id are specified as the first argument to an element. Attributes are just <a href="https://github.com/mikesol/purescript-event/blob/master/src/FRP/Event.purs"><code>Event</code>-s</a>, so you can <code>pure</code> them to make them happen <i>now</i>, combine two event streams with <code>alt</code> to compose events, etc.</p>

  <p>As an example, we made the input a range slider using <code>pure (Xtype := "range")</code>. Unlike Halogen, there are no checks to make sure you give a valid string. So if you want your range slider to have the value of true, you can. One day, I may build some validators, but passing strings works decently well here.</p>

  <h2>Next steps</h2>
  <p>In this section, we built a simple component. In the next section, we'll recreate the exact same element using a different input syntax called <a ~next~ style="cursor:pointer;">Pursx</a>.</p>
</div>`}})()()(ar()(Gr()(ar()(Lr(r.MonadST5().Monad0().Applicative0()))({reflectType:function(){return"result"}})({reflectSymbol:function(){return"result"}})(r))({reflectType:function(){return"next"}})({reflectSymbol:function(){return"next"}})(r))({reflectType:function(){return"code"}})({reflectSymbol:function(){return"code"}})(r))(r)(dg)({code:ur(Fr(r)([$r(r)([qt(r.MonadST5())(wl)])])),result:ur(Kt(r)([dl(r)([qt(r.MonadST5())("I do nothing")]),yl(r)(k(Ar)(function(){var e=kl(r),n=p(ro),u=qt(r.MonadST5());return function(o){return e(n(u(o)))}}())(["A","B","C"])),Kt(r)([wo(r)(p(j(r.MonadST5()))(ut(Br)(Ir.value)("https://example.com")))([qt(r.MonadST5())("foo ")]),Al(r)([qt(r.MonadST5())(" bar ")]),Rn(r)(p(j(r.MonadST5()))(ut(Ia)(fe.value)("font-weight: 800;")))([qt(r.MonadST5())(" baz")])]),Kt(r)([Kt(r)([Kt(r)([tu(r)(p(j(r.MonadST5()))(ut(pf)(Gu.value)("range")))([])])])])])),next:Dr(ct)(d(r.MonadST5().Monad0().Applicative0()))(p(j(r.MonadST5())))([ut(gr)(lr.value)(cr(function(e){return mt(or)(mt(or)(Wr(e))(t.dpage(Oa.value)))(ue)})),ut(Br)(Ir.value)(t.slug+"pursx1/")])})}};function am(t,r,e,n,u){return function(o,c){var l=t.newXHR(),v=t.fixupUrl(u.url,l);if(l.open(u.method||"GET",v,!0,u.username,u.password),u.headers)try{for(var s=0,m;(m=u.headers[s])!=null;s++)l.setRequestHeader(m.field,m.value)}catch(D){o(D)}var b=function(D){return function(){o(new Error(D))}};return l.onerror=b(e),l.ontimeout=b(r),l.onload=function(){c({status:l.status,statusText:l.statusText,headers:l.getAllResponseHeaders().split(`\r
`).filter(function(D){return D.length>0}).map(function(D){var a=D.indexOf(":");return n(D.substring(0,a))(D.substring(a+2))}),body:l.response})},l.responseType=u.responseType,l.withCredentials=u.withCredentials,l.timeout=u.timeout,l.send(u.content),function(D,a,A){try{l.abort()}catch(Q){return a(Q)}return A()}}}var bf="application/json",om="application/x-www-form-urlencoded";var fm=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),cm=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),lm=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),pm=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),_m=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),Rl=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),Nl=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),sm=function(t){return t instanceof Rl?new C(om):t instanceof Nl?new C(bf):w.value};var df=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),Af=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),vm=function(){function t(r,e){this.value0=r,this.value1=e}return t.create=function(r){return function(e){return new t(r,e)}},t}(),mm=function(t){if(t instanceof df)return Er()(t.value0);if(t instanceof Af)return Er()(t.value0);if(t instanceof vm)return t.value1;throw new Error("Failed pattern match at Affjax.RequestHeader (line 26, column 1 - line 26, column 33): "+[t.constructor.name])};var Bl=function(t){if(t instanceof df)return"Accept";if(t instanceof Af)return"Content-Type";if(t instanceof vm)return t.value0;throw new Error("Failed pattern match at Affjax.RequestHeader (line 21, column 1 - line 21, column 32): "+[t.constructor.name])};var Hl=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),Wl=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),Ul=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),Io=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),ql=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),kf=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),Dm=function(t){if(t instanceof Hl)return"arraybuffer";if(t instanceof Wl)return"blob";if(t instanceof Ul)return"document";if(t instanceof Io||t instanceof ql)return"text";if(t instanceof kf)return"";throw new Error("Failed pattern match at Affjax.ResponseFormat (line 44, column 3 - line 50, column 19): "+[t.constructor.name])},bm=function(t){return t instanceof Io?new C(bf):w.value};var dm=function(){return new Io(kt(st))}(),Am=function(){return new kf(kt(st))}();var ym=function(){function t(r,e){this.value0=r,this.value1=e}return t.create=function(r){return function(e){return new t(r,e)}},t}();function za(t){return new Error(t)}function Lo(t){return t.message}function Po(t){return function(){throw t}}var dn=function(t){return t.throwError};var uu=function(t){return t.catchError};var gf=function(t){return function(r){return uu(t)(k(t.MonadThrow0().Monad0().Bind1().Apply0().Functor0())(et.create)(r))(function(){var e=p(t.MonadThrow0().Monad0().Applicative0());return function(n){return e(it.create(n))}}())}};var Bn=function(t){return t.state};var Va=function(t){return function(r){return Bn(t)(function(e){var n=r(e);return new H(n,n)})}};var nn=function(t){return t.liftEffect};var zl=function(t){return t};var Vl=function(t){return t};var Ef=function(t){return function(r){return t(r)}},Cm=function(t){return{map:function(r){return Ef(k(t)(k(oa)(r)))}}};var Jl=function(t){return{Applicative0:function(){return Zu(t)},Bind1:function(){return jl(t)}}},jl=function(t){return{bind:function(r){return function(e){return L(t.Bind1())(r)(Ge(function(){var n=p(t.Applicative0());return function(u){return n(it.create(u))}}())(function(n){var u=e(n);return u}))}},Apply0:function(){return Tm(t)}}},Tm=function(t){return{apply:Ke(Jl(t)),Functor0:function(){return Cm(t.Bind1().Apply0().Functor0())}}},Zu=function(t){return{pure:function(){var r=p(t.Applicative0());return function(e){return zl(r(et.create(e)))}}(),Apply0:function(){return Tm(t)}}};var Sm=function(t){return{throwError:function(){var r=p(t.Applicative0());return function(e){return zl(r(it.create(e)))}}(),Monad0:function(){return Jl(t)}}};var Xl=function(t){return function(r){return{alt:function(e){return function(n){return L(r.Bind1())(e)(function(u){if(u instanceof et)return p(r.Applicative0())(new et(u.value0));if(u instanceof it)return L(r.Bind1())(n)(function(o){if(o instanceof et)return p(r.Applicative0())(new et(o.value0));if(o instanceof it)return p(r.Applicative0())(new it(W(t)(u.value0)(o.value0)));throw new Error("Failed pattern match at Control.Monad.Except.Trans (line 86, column 9 - line 88, column 49): "+[o.constructor.name])});throw new Error("Failed pattern match at Control.Monad.Except.Trans (line 82, column 5 - line 88, column 49): "+[u.constructor.name])})}},Functor0:function(){return Cm(r.Bind1().Apply0().Functor0())}}}};var hm=function(){var t=Er();return function(r){return t(Vl(r))}}();function Gl(t){return JSON.stringify(t)}function Ql(t){return function(r){return JSON.stringify(r,null,t)}}var Em=gu;function Fm(t,r,e){try{return r(JSON.parse(e))}catch(n){return t(n.message)}}var Mm=function(t){return Fm(it.create,et.create,t)};var Ff=function(t){return function(r){return function(e){return e.replace(t,r)}}};var Yl=function(t){return function(r){return r.join(t)}};function Pg(t){return t.replace(/[!'()*]/g,function(r){return"%"+r.charCodeAt(0).toString(16)})}var Im=function(r,e,n){try{return e(Pg(encodeURIComponent(n)).replace(/%20/g,"+"))}catch(u){return r(u)}};var Mf=function(){return Sc(Im)(g(w.value))(C.create)}();var Ng=function(t){return t};var Lm=function(){var t=function(n){if(n.value1 instanceof w)return Mf(n.value0);if(n.value1 instanceof C)return It(xu)(k(pr)(function(u){return function(o){return u+("="+o)}})(Mf(n.value0)))(Mf(n.value1.value0));throw new Error("Failed pattern match at Data.FormURLEncoded (line 37, column 16 - line 39, column 114): "+[n.constructor.name])},r=k(pr)(Yl("&")),e=ke(Qn)(Vr)(t);return function(n){return r(e(Ng(n)))}}();var Hg=function(){function t(){}return t.value=new t,t}(),Uo=function(){function t(){}return t.value=new t,t}(),Wg=function(){function t(){}return t.value=new t,t}(),Pm=function(){function t(){}return t.value=new t,t}(),Om=function(){function t(){}return t.value=new t,t}(),Rm=function(){function t(){}return t.value=new t,t}(),Ug=function(){function t(){}return t.value=new t,t}(),qg=function(){function t(){}return t.value=new t,t}(),zg=function(){function t(){}return t.value=new t,t}(),Vg=function(){function t(){}return t.value=new t,t}(),Jg=function(){function t(){}return t.value=new t,t}(),jg=function(){function t(){}return t.value=new t,t}(),Xg=function(){function t(){}return t.value=new t,t}(),Gg=function(){function t(){}return t.value=new t,t}(),Qg=function(){function t(){}return t.value=new t,t}(),Nm=function(){function t(){}return t.value=new t,t}();var Yg=function(t){return t},Zg={show:function(t){if(t instanceof Hg)return"OPTIONS";if(t instanceof Uo)return"GET";if(t instanceof Wg)return"HEAD";if(t instanceof Pm)return"POST";if(t instanceof Om)return"PUT";if(t instanceof Rm)return"DELETE";if(t instanceof Ug)return"TRACE";if(t instanceof qg)return"CONNECT";if(t instanceof zg)return"PROPFIND";if(t instanceof Vg)return"PROPPATCH";if(t instanceof Jg)return"MKCOL";if(t instanceof jg)return"COPY";if(t instanceof Xg)return"MOVE";if(t instanceof Gg)return"LOCK";if(t instanceof Qg)return"UNLOCK";if(t instanceof Nm)return"PATCH";throw new Error("Failed pattern match at Data.HTTP.Method (line 43, column 1 - line 59, column 23): "+[t.constructor.name])}};var Bm=Ge(tt(Zg))(Yg);var Um=function(){var t=Ei(Cc);return function(r){return $i(t(r))}}();var qm=function(t){return t.value0};var xe=function(){var t={},r="Pure",e="Throw",n="Catch",u="Sync",o="Async",c="Bind",l="Bracket",v="Fork",s="Sequential",m="Map",b="Apply",D="Alt",a="Cons",A="Resume",Q="Release",Pt="Finalizer",tr="Finalized",zt="Forked",we="Fiber",ae="Thunk";function rt(K,Gt,Tr,rr){this.tag=K,this._1=Gt,this._2=Tr,this._3=rr}function Zr(K){var Gt=function(Tr,rr,pt){return new rt(K,Tr,rr,pt)};return Gt.tag=K,Gt}function Ga(K){return new rt(r,void 0)}function Ib(K){try{K()}catch(Gt){setTimeout(function(){throw Gt},0)}}function Lb(K,Gt,Tr){try{return Gt(Tr())}catch(rr){return K(rr)}}function Pb(K,Gt,Tr){try{return Gt(Tr)()}catch(rr){return Tr(K(rr))(),Ga}}var Zo=function(){var K=1024,Gt=0,Tr=0,rr=new Array(K),pt=!1;function J(){var Yt;for(pt=!0;Gt!==0;)Gt--,Yt=rr[Tr],rr[Tr]=void 0,Tr=(Tr+1)%K,Yt();pt=!1}return{isDraining:function(){return pt},enqueue:function(Yt){var wt,Cr;Gt===K&&(Cr=pt,J(),pt=Cr),rr[(Tr+Gt)%K]=Yt,Gt++,pt||J()}}}();function Ob(K){var Gt={},Tr=0,rr=0;return{register:function(pt){var J=Tr++;pt.onComplete({rethrow:!0,handler:function(Yt){return function(){rr--,delete Gt[J]}}})(),Gt[J]=pt,rr++},isEmpty:function(){return rr===0},killAll:function(pt,J){return function(){if(rr===0)return J();var Yt=0,wt={};function Cr(ir){wt[ir]=Gt[ir].kill(pt,function(Mr){return function(){delete wt[ir],Yt--,K.isLeft(Mr)&&K.fromLeft(Mr)&&setTimeout(function(){throw K.fromLeft(Mr)},0),Yt===0&&J()}})()}for(var Kr in Gt)Gt.hasOwnProperty(Kr)&&(Yt++,Cr(Kr));return Gt={},Tr=0,rr=0,function(ir){return new rt(u,function(){for(var Mr in wt)wt.hasOwnProperty(Mr)&&wt[Mr]()})}}}}}var ta=0,Te=1,Ko=2,ti=3,ri=4,Ie=5,Qa=6;function Gf(K,Gt,Tr){var rr=0,pt=ta,J=Tr,Yt=null,wt=null,Cr=null,Kr=null,ir=null,Mr=0,Eu=0,We=null,ou=!0;function iu(_t){for(var vt,Ht,Jt;;)switch(vt=null,Ht=null,Jt=null,pt){case Ko:pt=Te;try{J=Cr(J),Kr===null?Cr=null:(Cr=Kr._1,Kr=Kr._2)}catch(oe){pt=Ie,Yt=K.left(oe),J=null}break;case ti:K.isLeft(J)?(pt=Ie,Yt=J,J=null):Cr===null?pt=Ie:(pt=Ko,J=K.fromRight(J));break;case Te:switch(J.tag){case c:Cr&&(Kr=new rt(a,Cr,Kr)),Cr=J._2,pt=Te,J=J._1;break;case r:Cr===null?(pt=Ie,J=K.right(J._1)):(pt=Ko,J=J._1);break;case u:pt=ti,J=Lb(K.left,K.right,J._1);break;case o:pt=ri,J=Pb(K.left,J._1,function(oe){return function(){rr===_t&&(rr++,Zo.enqueue(function(){rr===_t+1&&(pt=ti,J=oe,iu(rr))}))}});return;case e:pt=Ie,Yt=K.left(J._1),J=null;break;case n:Cr===null?ir=new rt(a,J,ir,wt):ir=new rt(a,J,new rt(a,new rt(A,Cr,Kr),ir,wt),wt),Cr=null,Kr=null,pt=Te,J=J._1;break;case l:Mr++,Cr===null?ir=new rt(a,J,ir,wt):ir=new rt(a,J,new rt(a,new rt(A,Cr,Kr),ir,wt),wt),Cr=null,Kr=null,pt=Te,J=J._1;break;case v:pt=ti,vt=Gf(K,Gt,J._2),Gt&&Gt.register(vt),J._1&&vt.run(),J=K.right(vt);break;case s:pt=Te,J=Nb(K,Gt,J._1);break}break;case Ie:if(Cr=null,Kr=null,ir===null)pt=Qa,J=wt||Yt||J;else switch(vt=ir._3,Jt=ir._1,ir=ir._2,Jt.tag){case n:wt&&wt!==vt&&Mr===0?pt=Ie:Yt&&(pt=Te,J=Jt._2(K.fromLeft(Yt)),Yt=null);break;case A:wt&&wt!==vt&&Mr===0||Yt?pt=Ie:(Cr=Jt._1,Kr=Jt._2,pt=Ko,J=K.fromRight(J));break;case l:Mr--,Yt===null&&(Ht=K.fromRight(J),ir=new rt(a,new rt(Q,Jt._2,Ht),ir,vt),(wt===vt||Mr>0)&&(pt=Te,J=Jt._3(Ht)));break;case Q:ir=new rt(a,new rt(tr,J,Yt),ir,wt),pt=Te,wt&&wt!==vt&&Mr===0?J=Jt._1.killed(K.fromLeft(wt))(Jt._2):Yt?J=Jt._1.failed(K.fromLeft(Yt))(Jt._2):J=Jt._1.completed(K.fromRight(J))(Jt._2),Yt=null,Mr++;break;case Pt:Mr++,ir=new rt(a,new rt(tr,J,Yt),ir,wt),pt=Te,J=Jt._1;break;case tr:Mr--,pt=Ie,J=Jt._1,Yt=Jt._2;break}break;case Qa:for(var hr in We)We.hasOwnProperty(hr)&&(ou=ou&&We[hr].rethrow,Ib(We[hr].handler(J)));We=null,wt&&Yt?setTimeout(function(){throw K.fromLeft(Yt)},0):K.isLeft(J)&&ou&&setTimeout(function(){if(ou)throw K.fromLeft(J)},0);return;case ta:pt=Te;break;case ri:return}}function Sr(_t){return function(){if(pt===Qa)return ou=ou&&_t.rethrow,_t.handler(J)(),function(){};var vt=Eu++;return We=We||{},We[vt]=_t,function(){We!==null&&delete We[vt]}}}function At(_t,vt){return function(){if(pt===Qa)return vt(K.right(void 0))(),function(){};var Ht=Sr({rethrow:!1,handler:function(){return vt(K.right(void 0))}})();switch(pt){case ta:wt=K.left(_t),pt=Qa,J=wt,iu(rr);break;case ri:wt===null&&(wt=K.left(_t)),Mr===0&&(pt===ri&&(ir=new rt(a,new rt(Pt,J(_t)),ir,wt)),pt=Ie,J=null,Yt=null,iu(++rr));break;default:wt===null&&(wt=K.left(_t)),Mr===0&&(pt=Ie,J=null,Yt=null)}return Ht}}function Ot(_t){return function(){var vt=Sr({rethrow:!1,handler:_t})();return pt===ta&&iu(rr),vt}}return{kill:At,join:Ot,onComplete:Sr,isSuspended:function(){return pt===ta},run:function(){pt===ta&&(Zo.isDraining()?iu(rr):Zo.enqueue(function(){iu(rr)}))}}}function Rb(K,Gt,Tr,rr){var pt=0,J={},Yt=0,wt={},Cr=new Error("[ParAff] Early exit"),Kr=null,ir=t;function Mr(Sr,At,Ot){var _t=At,vt=null,Ht=null,Jt=0,hr={},oe,Ya;t:for(;;)switch(oe=null,_t.tag){case zt:if(_t._3===t&&(oe=J[_t._1],hr[Jt++]=oe.kill(Sr,function(Bb){return function(){Jt--,Jt===0&&Ot(Bb)()}})),vt===null)break t;_t=vt._2,Ht===null?vt=null:(vt=Ht._1,Ht=Ht._2);break;case m:_t=_t._2;break;case b:case D:vt&&(Ht=new rt(a,vt,Ht)),vt=_t,_t=_t._1;break}if(Jt===0)Ot(K.right(void 0))();else for(Ya=0,oe=Jt;Ya<oe;Ya++)hr[Ya]=hr[Ya]();return hr}function Eu(Sr,At,Ot){var _t,vt,Ht,Jt,hr,oe;K.isLeft(Sr)?(_t=Sr,vt=null):(vt=Sr,_t=null);t:for(;;){if(Ht=null,Jt=null,hr=null,oe=null,Kr!==null)return;if(At===null){rr(_t||vt)();return}if(At._3!==t)return;switch(At.tag){case m:_t===null?(At._3=K.right(At._1(K.fromRight(vt))),vt=At._3):At._3=_t;break;case b:if(Ht=At._1._3,Jt=At._2._3,_t){if(At._3=_t,hr=!0,oe=Yt++,wt[oe]=Mr(Cr,_t===Ht?At._2:At._1,function(){return function(){delete wt[oe],hr?hr=!1:Ot===null?Eu(_t,null,null):Eu(_t,Ot._1,Ot._2)}}),hr){hr=!1;return}}else{if(Ht===t||Jt===t)return;vt=K.right(K.fromRight(Ht)(K.fromRight(Jt))),At._3=vt}break;case D:if(Ht=At._1._3,Jt=At._2._3,Ht===t&&K.isLeft(Jt)||Jt===t&&K.isLeft(Ht))return;if(Ht!==t&&K.isLeft(Ht)&&Jt!==t&&K.isLeft(Jt))_t=vt===Ht?Jt:Ht,vt=null,At._3=_t;else if(At._3=vt,hr=!0,oe=Yt++,wt[oe]=Mr(Cr,vt===Ht?At._2:At._1,function(){return function(){delete wt[oe],hr?hr=!1:Ot===null?Eu(vt,null,null):Eu(vt,Ot._1,Ot._2)}}),hr){hr=!1;return}break}Ot===null?At=null:(At=Ot._1,Ot=Ot._2)}}function We(Sr){return function(At){return function(){delete J[Sr._1],Sr._3=At,Eu(At,Sr._2._1,Sr._2._2)}}}function ou(){var Sr=Te,At=Tr,Ot=null,_t=null,vt,Ht;t:for(;;)switch(vt=null,Ht=null,Sr){case Te:switch(At.tag){case m:Ot&&(_t=new rt(a,Ot,_t)),Ot=new rt(m,At._1,t,t),At=At._2;break;case b:Ot&&(_t=new rt(a,Ot,_t)),Ot=new rt(b,t,At._2,t),At=At._1;break;case D:Ot&&(_t=new rt(a,Ot,_t)),Ot=new rt(D,t,At._2,t),At=At._1;break;default:Ht=pt++,Sr=Ie,vt=At,At=new rt(zt,Ht,new rt(a,Ot,_t),t),vt=Gf(K,Gt,vt),vt.onComplete({rethrow:!1,handler:We(At)})(),J[Ht]=vt,Gt&&Gt.register(vt)}break;case Ie:if(Ot===null)break t;Ot._1===t?(Ot._1=At,Sr=Te,At=Ot._2,Ot._2=t):(Ot._2=At,At=Ot,_t===null?Ot=null:(Ot=_t._1,_t=_t._2))}for(ir=At,Ht=0;Ht<pt;Ht++)J[Ht].run()}function iu(Sr,At){Kr=K.left(Sr);var Ot;for(var _t in wt)if(wt.hasOwnProperty(_t)){Ot=wt[_t];for(_t in Ot)Ot.hasOwnProperty(_t)&&Ot[_t]()}wt=null;var vt=Mr(Sr,ir,At);return function(Ht){return new rt(o,function(Jt){return function(){for(var hr in vt)vt.hasOwnProperty(hr)&&vt[hr]();return Ga}})}}return ou(),function(Sr){return new rt(o,function(At){return function(){return iu(Sr,At)}})}}function Nb(K,Gt,Tr){return new rt(o,function(rr){return function(){return Rb(K,Gt,Tr,rr)}})}return rt.EMPTY=t,rt.Pure=Zr(r),rt.Throw=Zr(e),rt.Catch=Zr(n),rt.Sync=Zr(u),rt.Async=Zr(o),rt.Bind=Zr(c),rt.Bracket=Zr(l),rt.Fork=Zr(v),rt.Seq=Zr(s),rt.ParMap=Zr(m),rt.ParApply=Zr(b),rt.ParAlt=Zr(D),rt.Fiber=Gf,rt.Supervisor=Ob,rt.Scheduler=Zo,rt.nonCanceler=Ga,rt}(),Vm=xe.Pure,Jm=xe.Throw;function jm(t){return function(r){return xe.Catch(t,r)}}function Xm(t){return function(r){return r.tag===xe.Pure.tag?xe.Pure(t(r._1)):xe.Bind(r,function(e){return xe.Pure(t(e))})}}function Gm(t){return function(r){return xe.Bind(t,r)}}var Qm=xe.Sync;var qo=xe.Async;function Ym(t,r){return function(){return xe.Fiber(t,null,r)}}var Kg=function(){function t(e,n){return e===0&&typeof setImmediate<"u"?setImmediate(n):setTimeout(n,e)}function r(e,n){return e===0&&typeof clearImmediate<"u"?clearImmediate(n):clearTimeout(n)}return function(e,n){return xe.Async(function(u){return function(){var o=t(n,u(e()));return function(){return xe.Sync(function(){return e(r(n,o))})}}})}}(),tC=xe.Seq;var ja={proof:function(t){return t},Coercible0:function(){}};var vC=function(t,r,e){var n=0,u;return function(o){if(n===2)return u;if(n===1)throw new ReferenceError(t+" was needed before it finished initializing (module "+r+", line "+o+")",r,o);return n=1,u=e(),n=2,u}};var ep={map:Xm};var mC=function(){var t=function(n){if(n instanceof et)return n.value0;if(n instanceof it)return fn("unsafeFromRight: Left");throw new Error("Failed pattern match at Effect.Aff (line 407, column 21 - line 409, column 54): "+[n.constructor.name])},r=function(n){if(n instanceof it)return n.value0;if(n instanceof et)return fn("unsafeFromLeft: Right");throw new Error("Failed pattern match at Effect.Aff (line 402, column 20 - line 404, column 55): "+[n.constructor.name])},e=function(n){if(n instanceof it)return!0;if(n instanceof et)return!1;throw new Error("Failed pattern match at Effect.Aff (line 397, column 12 - line 399, column 21): "+[n.constructor.name])};return{isLeft:e,fromLeft:r,fromRight:t,left:it.create,right:et.create}}(),DC=function(t){return Ym(mC,t)},bC=function(t){return function(){var e=DC(t)();return e.run(),e}},np=function(){var t=at(O);return function(r){return t(bC(r))}}();var up={Applicative0:function(){return xf},Bind1:function(){return ap}},ap={bind:Gm,Apply0:function(){return eD(0)}},xf={pure:Vm,Apply0:function(){return eD(0)}},eD=vC("applyAff","Effect.Aff",function(){return{apply:Ke(up),Functor0:function(){return ep}}});var wf={liftEffect:Qm,Monad0:function(){return up}};var dC={throwError:Jm,Monad0:function(){return up}},nD={catchError:jm,MonadThrow0:function(){return dC}};var uD=g(p(xf)(void 0));var cD=function(t){return qo(function(r){return function(){var n=t(function(u){return r(it.create(u))()},function(u){return r(et.create(u))()});return function(u){return qo(function(o){return function(){return n(u,function(l){return o(it.create(l))()},function(l){return o(et.create(l))()}),uD}})}}})};function Lf(t){return Object.prototype.toString.call(t).slice(8,-1)}var lD=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};var pD=function(t){return function(r){return function(e){return(e|0)===e?t(e):r}}},Ce=function(t){return t};var Pf=isFinite;var fp=Math.floor;var zo=function(t){return function(r){return t%r}};var Of=function(){return pD(C.create)(w.value)}(),UC=function(t){if(!Pf(t))return 0;if(t>=Ce(Je(Mu)))return Je(Mu);if(t<=Ce(un(Mu)))return un(Mu);if(ce)return pe(0)(Of(t));throw new Error("Failed pattern match at Data.Int (line 72, column 1 - line 72, column 29): "+[t.constructor.name])};var lp=function(t){return UC(fp(t))};var pp=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),kD=function(){function t(r,e){this.value0=r,this.value1=e}return t.create=function(r){return function(e){return new t(r,e)}},t}(),GC=function(){function t(r,e){this.value0=r,this.value1=e}return t.create=function(r){return function(e){return new t(r,e)}},t}(),QC=function(){function t(r,e){this.value0=r,this.value1=e}return t.create=function(r){return function(e){return new t(r,e)}},t}(),Tu=q,YC=q;var Nf=function(t){if(t instanceof pp)return t.value0;if(t instanceof GC)return"Error at array index "+(tt(je)(t.value0)+(": "+Nf(t.value1)));if(t instanceof QC)return"Error at property "+(tt(Ae)(t.value0)+(": "+Nf(t.value1)));if(t instanceof kD)return"Type mismatch: expected "+(t.value0+(", found "+t.value1));throw new Error("Failed pattern match at Foreign (line 78, column 1 - line 78, column 45): "+[t.constructor.name])};var _p=function(t){var r=dn(Sm(t));return function(e){return r(Um(e))}};var Su=function(t){return function(r){return function(e){if(Lf(e)===r)return p(Zu(t))(YC(e));if(ce)return _p(t)(new kD(r,Lf(e)));throw new Error("Failed pattern match at Foreign (line 123, column 1 - line 123, column 104): "+[r.constructor.name,e.constructor.name])}}};var sp=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),vp=function(){function t(r,e){this.value0=r,this.value1=e}return t.create=function(r){return function(e){return new t(r,e)}},t}(),mp=function(){function t(){}return t.value=new t,t}(),Dp=function(){function t(){}return t.value=new t,t}(),bp=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),yD=function(t){return function(r){var e=function(m){return m===""?p(Zu(mr))(Em):Ge(function(){var b=_p(mr);return function(D){return b(pp.create(D))}}())(p(Zu(mr)))(Mm(m))},n=function(){if(r.responseFormat instanceof Hl)return Su(mr)("ArrayBuffer");if(r.responseFormat instanceof Wl)return Su(mr)("Blob");if(r.responseFormat instanceof Ul)return function(m){return ft(Xl(gc)(mr))(Su(mr)("Document")(m))(ft(Xl(gc)(mr))(Su(mr)("XMLDocument")(m))(Su(mr)("HTMLDocument")(m)))};if(r.responseFormat instanceof Io)return ci(jl(mr))(function(m){return r.responseFormat.value0(e(m))})(Su(mr)("String"));if(r.responseFormat instanceof ql)return Su(mr)("String");if(r.responseFormat instanceof kf)return g(r.responseFormat.value0(p(Zu(mr))(void 0)));throw new Error("Failed pattern match at Affjax (line 274, column 18 - line 283, column 57): "+[r.responseFormat.constructor.name])}(),u=function(m){if(m instanceof fm)return new et(m.value0(Tu));if(m instanceof cm)return new et(Tu(m.value0));if(m instanceof lm)return new et(Tu(m.value0));if(m instanceof pm)return new et(Tu(m.value0));if(m instanceof _m)return new et(Tu(m.value0));if(m instanceof Rl)return nc("Body contains values that cannot be encoded as application/x-www-form-urlencoded")(k(pr)(Tu)(Lm(m.value0)));if(m instanceof Nl)return new et(Tu(Gl(m.value0)));throw new Error("Failed pattern match at Affjax (line 235, column 20 - line 250, column 69): "+[m.constructor.name])},o=function(m){return function(b){return m instanceof C&&!pu(ct)(_e)(Qf(Et(cu))(Bl)(m.value0))(b)?Bi(b)(m.value0):b}},c=function(m){return o(k(pr)(Af.create)(Vn($e)(sm)(m)))(o(k(pr)(df.create)(bm(r.responseFormat)))(r.headers))},l=function(m){return{method:Bm(r.method),url:r.url,headers:k(Ar)(function(b){return{field:Bl(b),value:mm(b)}})(c(r.content)),content:m,responseType:Dm(r.responseFormat),username:qa(r.username),password:qa(r.password),withCredentials:r.withCredentials,timeout:pe(0)(k(pr)(function(b){return b})(r.timeout))}},v=function(m){return Ue(ep)(gf(nD)(cD(am(t,"AffjaxTimeoutErrorMessageIdent","AffjaxRequestFailedMessageIdent",ym.create,l(m)))))(function(b){if(b instanceof et){var D=hm(n(b.value0.body));if(D instanceof it)return new it(new vp(qm(D.value0),b.value0));if(D instanceof et)return new et({body:D.value0,headers:b.value0.headers,status:b.value0.status,statusText:b.value0.statusText});throw new Error("Failed pattern match at Affjax (line 209, column 9 - line 211, column 52): "+[D.constructor.name])}if(b instanceof it)return new it(function(){var a=Lo(b.value0),A=a==="AffjaxTimeoutErrorMessageIdent";if(A)return mp.value;var Q=a==="AffjaxRequestFailedMessageIdent";return Q?Dp.value:new bp(b.value0)}());throw new Error("Failed pattern match at Affjax (line 207, column 144 - line 219, column 28): "+[b.constructor.name])})};if(r.content instanceof w)return v(qa(w.value));if(r.content instanceof C){var s=u(r.content.value0);if(s instanceof et)return v(qa(new C(s.value0)));if(s instanceof it)return p(xf)(new it(new sp(s.value0)));throw new Error("Failed pattern match at Affjax (line 199, column 7 - line 203, column 48): "+[s.constructor.name])}throw new Error("Failed pattern match at Affjax (line 195, column 3 - line 203, column 48): "+[r.content.constructor.name])}},dp=function(t){if(t instanceof sp)return"There was a problem with the request content: "+t.value0;if(t instanceof vp)return"There was a problem with the response body: "+Nf(t.value0);if(t instanceof mp)return"There was a problem making the request: timeout";if(t instanceof Dp)return"There was a problem making the request: request failed";if(t instanceof bp)return"There was a problem making the request: "+Lo(t.value0);throw new Error("Failed pattern match at Affjax (line 113, column 14 - line 123, column 66): "+[t.constructor.name])},hu=function(){return{method:new it(Uo.value),url:"/",headers:[],content:w.value,username:w.value,password:w.value,withCredentials:!1,responseFormat:Am,timeout:w.value}}();var Ap={newXHR:function(){return new XMLHttpRequest},fixupUrl:function(t){return t||"/"}};var CD=yD(Ap);var SD=function(){function t(){}return t.value=new t,t}(),kp=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),rT=function(){return z.value}(),TD="Click to get some random user data.",eT=function(t){return cr(g(function(){return t(SD.value)(),np(L(ap)(CD({method:new it(Uo.value),url:"https://randomuser.me/api/",headers:hu.headers,content:hu.content,username:hu.username,password:hu.password,withCredentials:hu.withCredentials,responseFormat:dm,timeout:hu.timeout}))(function(e){if(e instanceof it)return nn(wf)(t(new kp("GET /api response failed to decode: "+dp(e.value0))));if(e instanceof et)return nn(wf)(t(new kp(Ql(2)(e.value0.body))));throw new Error("Failed pattern match at Deku.Example.Docs.Effects (line 44, column 9 - line 51, column 48): "+[e.constructor.name])}))()}))},hD=function(t){return function(r){return Hr({reflectType:function(){return`<div>
  <h1>Effects</h1>

  <h2>Let's make a network call</h2>
  <p>
    This example is similar to the previous one in its design: the looping function is called in response to an event. The difference is that the response isn't immediate. Instead, we wait for the result of a network call.
  </p>

  ~code~

  <p>And here's what it produces:</p>

  <blockquote> ~result~ </blockquote>

  <h2>Arbitrary effects</h2>
  <p>Because all event listeners execute in the <code>Effect</code> monad, you can do more or less whatever you want. Make a network call, run a monad transformer stack just for fun, play music using <a href="https://github.com/mikesol/purescript-wags">purescript-wags</a>. The sky's the limit!</p>

  <p>Another useful pattern when working with effects is to throttle input. For example, if we are making a network call, we may want to show a loading indicator and prevent additional network calls. This can be achieved by setting the callback to a no-op while the network call is executing, as shown in the example above.</p>

  <h2>Next steps</h2>
  <p>It is also possible to handle events (and by extension effectful actions in events, like network calls) in Pursx. Let's see how in the <a ~next~ style="cursor:pointer;">second Pursx section</a>.</p>
</div>`}})()()(ar()(Gr()(ar()(Lr(r.MonadST5().Monad0().Applicative0()))({reflectType:function(){return"result"}})({reflectSymbol:function(){return"result"}})(r))({reflectType:function(){return"next"}})({reflectSymbol:function(){return"next"}})(r))({reflectType:function(){return"code"}})({reflectSymbol:function(){return"code"}})(r))(r)(rT)({code:ur(Fr(r)([$r(r)([qt(r.MonadST5())(xl)])])),result:ur($a(r)(r.Always2())(function(e){return function(n){var u=ye(mn(r.MonadST5().Monad0().Applicative0()))(function(l){return l instanceof SD?new C(new it(void 0)):l instanceof kp?new C(new et(l.value0)):w.value})(n),o=ye(mn(r.MonadST5().Monad0().Applicative0()))(function(l){return l instanceof et?new C(l.value0):w.value})(u),c=ye(mn(r.MonadST5().Monad0().Applicative0()))(function(l){return l instanceof it?new C(void 0):w.value})(u);return Kt(r)([Kt(r)([De(r)(p(j(r.MonadST5()))(ut(gr)(lr.value)(eT(e))))([Be(r.MonadST5())(ft(Vt(r.MonadST5().Monad0().Applicative0()))(p(j(r.MonadST5()))(TD))(ft(Vt(r.MonadST5().Monad0().Applicative0()))(N(Zt)(c)("Loading..."))(N(Zt)(o)(TD))))])]),en(r)(ft(Vt(r.MonadST5().Monad0().Applicative0()))(p(j(r.MonadST5()))(ut(ml)(fe.value)("display: none;")))(N(Zt)(zu(ho(r.MonadST5().Monad0().Applicative0()))(Ju(me(r.MonadST5()))(function(l){return function(v){return new H(v&&!1,function(){return v?new C(void 0):w.value}())}})(o)(!0)))(ut(ml)(fe.value)("display: block;"))))([Fr(r)([$r(r)([Be(r.MonadST5())(ft(Vt(r.MonadST5().Monad0().Applicative0()))(p(j(r.MonadST5()))(""))(o))])])])])}})),next:Dr(ct)(d(r.MonadST5().Monad0().Applicative0()))(p(j(r.MonadST5())))([ut(gr)(lr.value)(cr(function(e){return mt(or)(mt(or)(Wr(e))(t.dpage(Ra.value)))(ue)})),ut(Br)(Ir.value)(t.slug+"pursx2/")])})}};var yp=function(){function t(){}return t.value=new t,t}(),ED={attr:function(t){return function(r){return i({key:"controls",value:S(r)})}}};var Jo=function(){function t(){}return t.value=new t,t}();var Bf={attr:function(t){return function(r){return i({key:"input",value:B(r)})}}};var Hf=function(){function t(){}return t.value=new t,t}();var gp={attr:function(t){return function(r){return i({key:"keyup",value:B(r)})}}};var Cp=function(){function t(){}return t.value=new t,t}();var MD={attr:function(t){return function(r){return i({key:"src",value:S(r)})}}};var Tp=function(){function t(){}return t.value=new t,t}(),xD={attr:function(t){return function(r){return i({key:"width",value:S(r)})}}};var wD=function(t){return function(r){return function(e){return new T(M(t)("p")(r)(F(e)))}}},Sp=function(t){return wD(t)(y(d(t.MonadST5().Monad0().Applicative0())))};var hp=function(t){return function(r){return function(e){return new T(M(t)("source")(r)(F(e)))}}};var Ep=function(t){return function(r){return function(e){return new T(M(t)("video")(r)(F(e)))}}};function Wf(t){return function(){return t.value}}function $p(t){return function(){return t.valueAsNumber}}function LD(t,r,e,n){if(typeof window<"u"){var u=window[e];if(u!=null&&n instanceof u)return r(n)}for(var o=n;o!=null;){var c=Object.getPrototypeOf(o),l=c.constructor.name;if(l===e)return r(n);if(l==="Object")return t;o=c}return t}var Y=function(t){return function(r){return LD(w.value,C.create,t,r)}};var Uf=Y("HTMLInputElement");function Fp(t){return t.code}var Mp=Y("KeyboardEvent");var qf=function(t){var r=ft(Vt(t.Monad0().Applicative0()))(p(j(t))(ut(pf)(Gu.value)("range"))),e=k(Zt)(function(n){return ut(Bf)(Jo.value)(cr(function(u){return qr(ie)(zr)(L($e)(Df(u))(Uf))(li(Hu)($p)(n))}))});return function(n){return r(e(n))}};var zf=function(t){return function(r){return function(e){return k(t)(function(){var n=ut(e)(lr.value);return function(u){return n(function(o){return o(xt(r))}(u))}}())}}};var kT=function(){return z.value}(),ND=function(t){return function(r){return Hr({reflectType:function(){return`<div>
  <h1>Events</h1>

  <h2>Listening to the DOM</h2>
  <p>
    We'll spice up the previous example by adding an event listener to our button. When we do, Deku will keep track of how many times we clicked it. The same goes for a range slider, whose current value is displayed underneath it.
  </p>

  ~code~

  <p>And here's what it produces:</p>

  <blockquote> ~result~ </blockquote>

  <h2>Event handling</h2>
  <p>All DOM event handlers, like <code>OnClick</code> and <code>OnInput</code>, can be set with a value of type <code>Cb</code>. This type is a <code>newtype</code> around <code>(Event -> Effect Boolean)</code>. To hook the event up to the Deku event bus, you can use the <code>push</code> function within the event handler. The push function has a signature of <code>(push -> Effect Unit)</code>. Here, the type one can push in to <code>push</code> is UIEvents. Whenever a push happens, our <code>Event</code> receives it and all attributes are updated accordingly.</p>

  <h2>Next steps</h2>
  <p>In this section, saw how to react to events. In the next section, we'll use a similar mechanism to deal with arbitrary <a ~next~ style="cursor:pointer;">effects</a>.</p>
</div>`}})()()(ar()(Gr()(ar()(Lr(r.MonadST5().Monad0().Applicative0()))({reflectType:function(){return"result"}})({reflectSymbol:function(){return"result"}})(r))({reflectType:function(){return"next"}})({reflectSymbol:function(){return"next"}})(r))({reflectType:function(){return"code"}})({reflectSymbol:function(){return"code"}})(r))(r)(kT)({code:ur(Fr(r)([$r(r)([qt(r.MonadST5())(Ml)])])),result:ur(nf()(r)()(ba({reflectSymbol:function(){return"buttonClicked"}})(da(Aa(r.Always2())(ja)))(ba({reflectSymbol:function(){return"sliderMoved"}})(da(Aa(r.Always2())(ja)))(Fi)()())()())(Sa({reflectSymbol:function(){return"buttonClicked"}})()()(Sa({reflectSymbol:function(){return"sliderMoved"}})()()(Qi)()()()())()()()())(z.value)(function(e){return function(n){return Kt(r)([De(r)(zf(Zt)(Xe)(wa)(p(j(r.MonadST5()))(e.buttonClicked)))([qt(r.MonadST5())("Click")]),Kt(r)([Be(r.MonadST5())(ft(Vt(r.MonadST5().Monad0().Applicative0()))(p(j(r.MonadST5()))("Val: 0"))(k(Zt)(function(){var u=W(qn)("Val: "),o=tt(je);return function(c){return u(o(c))}}())(Au(me(r.MonadST5()))(g(Pr(Le)(1)))(ft(Vt(r.MonadST5().Monad0().Applicative0()))(p(j(r.MonadST5()))(void 0))(n.buttonClicked))(-1))))]),Kt(r)([tu(r)(qf(r.MonadST5())(p(j(r.MonadST5()))(e.sliderMoved)))([]),Kt(r)([Be(r.MonadST5())(ft(Vt(r.MonadST5().Monad0().Applicative0()))(p(j(r.MonadST5()))("Val: 50.0"))(k(Zt)(function(){var u=W(qn)("Val: "),o=tt(ao);return function(c){return u(o(c))}}())(n.sliderMoved)))])])])}})),next:Dr(ct)(d(r.MonadST5().Monad0().Applicative0()))(p(j(r.MonadST5())))([ut(gr)(lr.value)(cr(function(e){return mt(or)(mt(or)(Wr(e))(t.dpage(Ba.value)))(ue)})),ut(Br)(Ir.value)(t.slug+"effects/")])})}};var gT=function(){function t(){}return t.value=new t,t}(),xp=function(){function t(){}return t.value=new t,t}(),BD=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),CT=function(){return z.value}(),HD=function(t){return function(r){return Hr({reflectType:function(){return`<div>
  <h1>Events 2</h1>

  <h2>Dynamic children</h2>
  <p>
    Up until now, our DOM has been static. This is OK in some cases, but in many cases, we need a dynamic DOM: one whose elements are inserted and removed based on user interaction. In Deku, we achieve this with <code>Event</code>-s.
  </p>

  <p>
    The code below creates a todo list that allows a user to add, prioritize, and remove elements.
  </p>

  ~code~

  <p>And here's what it produces:</p>

  <blockquote> ~result~ </blockquote>

  <h2>Events of events</h2>

  <p>In the previous sections, DOM element constructors like <code>div_</code> could only accept an <code>Array</code>. They <i>also</i> can accept an event of events. In this case, the outer event represents a dynamic element, and the inner event represents the <i>stage</i> of dynamism with a data type called <code>Child</code>. <code>Child</code> has three constructors:</p>

  <ul>
    <li><code>insert</code>, which takes an element.</li>
    <li><code>sendToTop</code>, which sends the current element to the top of its parent.</li>
    <li><code>remove</code>, which removes the element from its parent.</li>
  </ul>

  <p>The Deku engine listens for these in a specific order. <code>Insert</code> can be followed by 0 or more <code>SendToTop</code>-s. When a <code>Remove</code> is called, the stream is unsubscribed from the parent. Because we're in the land of <code>Event</code>-s, you can emit anything, but this is the how they will be listened to.</p>

  <h2>Next steps</h2>
  <p>In this section, we used nested events to insert and remove elements from a parent. In the next section, we'll see how we can use <a ~next~ style="cursor:pointer;">portals to move an element to a different place of the DOM</a>.</p>
</div>`}})()()(ar()(Gr()(ar()(Lr(r.MonadST5().Monad0().Applicative0()))({reflectType:function(){return"result"}})({reflectSymbol:function(){return"result"}})(r))({reflectType:function(){return"next"}})({reflectSymbol:function(){return"next"}})(r))({reflectType:function(){return"code"}})({reflectSymbol:function(){return"code"}})(r))(r)(CT)({code:ur(Fr(r)([$r(r)([qt(r.MonadST5())(Fl)])])),result:ur($a(r)(r.Always2())(function(e){return Me(ge)(function(n){return ft(Vt(r.MonadST5().Monad0().Applicative0()))(p(j(r.MonadST5()))(gT.value))(n)})(function(n){return Kt(r)([Kt(r)([tu(r)(Dr(ct)(d(r.MonadST5().Monad0().Applicative0()))(p(j(r.MonadST5())))([ut(zv)(fe.value)("border-style:solid;border-width: 1px;border-color: black;"),ut(Bf)(Jo.value)(cr(function(u){return qr(ie)(zr)(L($e)(Df(u))(Uf))(li(Hu)(Wf)(function(o){return e(BD.create(o))}))})),ut(gp)(Hf.value)(cr(function(u){return qr(ie)(zr)(Mp(u))(function(o){return Wn(ie)(Fp(o)==="Enter")(e(xp.value))})}))]))([]),De(r)(ft(Vt(r.MonadST5().Monad0().Applicative0()))(p(j(r.MonadST5()))(ut(cf)(fe.value)("margin: 5px;")))(p(j(r.MonadST5()))(ut(gr)(lr.value)(cr(g(e(xp.value)))))))([qt(r.MonadST5())("Add")])]),xa(r)(en(r))(k(Zt)(function(u){return Vu(me(r.MonadST5()))(yu(r)(r.Always2())(function(o){return function(c){return ft(Vt(r.MonadST5().Monad0().Applicative0()))(p(j(r.MonadST5()))(Xu(Kt(r)([Rn(r)(p(j(r.MonadST5()))(ut(Ia)(fe.value)("margin: 5px;")))([qt(r.MonadST5())(u)]),De(r)(ft(Vt(r.MonadST5().Monad0().Applicative0()))(p(j(r.MonadST5()))(ut(cf)(fe.value)("margin: 5px;")))(p(j(r.MonadST5()))(ut(gr)(lr.value)(cr(g(o(Sv)))))))([qt(r.MonadST5())("Prioritize")]),De(r)(ft(Vt(r.MonadST5().Monad0().Applicative0()))(p(j(r.MonadST5()))(ut(cf)(fe.value)("margin: 5px;")))(p(j(r.MonadST5()))(ut(gr)(lr.value)(cr(g(o(ul)))))))([qt(r.MonadST5())("Delete")])]))))(c)}}))})(ye(mn(r.MonadST5().Monad0().Applicative0()))(function(u){return u.value0?new C(u.value1):w.value})(Ju(me(r.MonadST5()))(function(u){return function(o){return u instanceof BD?new H(u.value0,new H(!1,u.value0)):u instanceof xp?new H(o,new H(!0,o)):new H("",new H(!1,""))}})(n)(""))))])})})),next:Dr(ct)(d(r.MonadST5().Monad0().Applicative0()))(p(j(r.MonadST5())))([ut(gr)(lr.value)(cr(function(e){return mt(or)(mt(or)(Wr(e))(t.dpage(Wa.value)))(ue)})),ut(Br)(Ir.value)(t.slug+"portals/")])})}};var ST=function(){return z.value}(),WD=function(t){return function(r){return Hr({reflectType:function(){return`<div>
  <h1>Hello world</h1>

  <h3>A small example</h3>

  <p>Here is "hello world" in Deku. In this and all the following sections, we'll start with a full example, and we'll pick it apart afterwards.</p>

  ~code~

  <p>And here's what it produces:</p>

  <blockquote> ~result~ </blockquote>

  <p>You gotta start somewhere!</p>

  <h2>Our top-level component</h2>

  <p>Deku sets up shop in an arbitrary DOM component. In the main function above, we use \u{1F680} to automatically insert our Deku tree into the body.</p>

  <h2>Next steps</h2>
  <p>Now that we have our setup running, let's make a more interesting <a ~next~ style="cursor:pointer;">component</a>.</p>
</div>`}})()()(ar()(Gr()(ar()(Lr(r.MonadST5().Monad0().Applicative0()))({reflectType:function(){return"result"}})({reflectSymbol:function(){return"result"}})(r))({reflectType:function(){return"next"}})({reflectSymbol:function(){return"next"}})(r))({reflectType:function(){return"code"}})({reflectSymbol:function(){return"code"}})(r))(r)(ST)({code:ur(Fr(r)([$r(r)([qt(r.MonadST5())($l)])])),result:ur(Kt(r)([qt(r.MonadST5())("Hello world")])),next:Dr(ct)(d(r.MonadST5().Monad0().Applicative0()))(p(j(r.MonadST5())))([ut(gr)(lr.value)(cr(function(e){return mt(or)(mt(or)(Wr(e))(t.dpage(Pa.value)))(ue)})),ut(Br)(Ir.value)(t.slug+"component/")])})}};var ET=function(){return z.value}(),UD=function(t){return function(r){return Hr({reflectType:function(){return`<div>
  <h1>Deku</h1>

  <h3>A web micro-framework written in PureScript</h3>

  <p>Hi! You've found <a href="https://github.com/mikesol/purescript-deku">Deku</a>.</p>

  <p>Deku is the coolest web micro-framework that no one knows about yet. Except you, of course, as you're here. So welcome!</p>

  <p>The main goal of Deku is speed. I made it for the purpose of creating interactive web-based musical instruments, but it's equally useful as a general-purpose web framework. Its standard event-handling patterns tend to outperform those of React and Vue by a factor of 1.5-2x.</p>

  <p>This documentation is written in Deku and can be found <a href="https://github.com/mikesol/purescript-deku/tree/main/examples/docs">here</a>. One good way to follow along is by using the Deku starter repo, which you can clone <a href="https://github.com/mikesol/purescript-deku-starter">here</a>.</p>

  <p>And now, without further ado, check out the <a ~next~ style="cursor:pointer;">hello world section</a>!</p>
</div>`}})()()(Gr()(Lr(r.MonadST5().Monad0().Applicative0()))({reflectType:function(){return"next"}})({reflectSymbol:function(){return"next"}})(r))(r)(ET)({next:Dr(ct)(d(r.MonadST5().Monad0().Applicative0()))(p(j(r.MonadST5())))([ut(gr)(lr.value)(cr(function(e){return mt(or)(mt(or)(Wr(e))(t.dpage(La.value)))(ue)})),ut(Br)(Ir.value)(t.slug+"hello/")])})}};var FT=function(){return z.value}(),qD=function(t){return function(r){return Hr({reflectType:function(){return`<div>
  <h1>Portals</h1>

  <h2>Zapping from place to place</h2>
  <p>
    Sometimes, we have referentially opaque nodes like videos or audio that we can't destroy and recreate when they need to move around the DOM. In these cases, we can use portals to "zap" nodes from one part of the DOM to another.
  </p>

  <p>
    The code below uses portals to flip two videos across a boundary. If you press play on either video, you'll see that it keeps playing uninterrupted, event when it is removed and reinserted.
  </p>

  ~code~

  <p>And here's what it produces:</p>

  <blockquote> ~result~ </blockquote>

  <h2>Events of portals</h2>

  <p>Portals work by sending a referentially-opaque reference to a DOM element into a closure where it can be safely used. Whenever an event is emitted containing the element, the element will be rendered at that place in the DOM, as in the example above. Note that portals "hog the blanket", meaning that they end up in the last place in which they were called.</p>

  <p><code>switcher</code> is a <a href="https://github.com/mikesol/purescript-deku/blob/ff3e2d2dc89b39088c5d5d6ab3492fb8730dd9a4/src/Deku/Control.purs#L325">small function</a> included in Deku to switch between different elements in an enclosure. It's how the tabs in this documentation are implemented as well.</p>

  <h2>Next steps</h2>
  <p>In this section, we used portals to move an element to different areas of the DOM. In the next section, we'll learn how to do <a ~next~ style="cursor:pointer;">static site rendering</a>.</p>
</div>`}})()()(ar()(Gr()(ar()(Lr(r.MonadST5().Monad0().Applicative0()))({reflectType:function(){return"result"}})({reflectSymbol:function(){return"result"}})(r))({reflectType:function(){return"next"}})({reflectSymbol:function(){return"next"}})(r))({reflectType:function(){return"code"}})({reflectSymbol:function(){return"code"}})(r))(r)(FT)({code:ur(Fr(r)([$r(r)([qt(r.MonadST5())(El)])])),result:ur(xa(r)(en(r))(yu(r)(r.Always2())(function(e){return Me(ge)(ft(Vt(r.MonadST5().Monad0().Applicative0()))(p(j(r.MonadST5()))(void 0)))(function(n){return p(j(r.MonadST5()))(Xu(Uv()(r)(k(Fa)(function(u){return Ep(r)(Dr(ct)(d(r.MonadST5().Monad0().Applicative0()))(p(j(r.MonadST5())))([ut(ED)(yp.value)("true"),ut(xD)(Tp.value)("250")]))([hp(r)(Dr(ct)(d(r.MonadST5().Monad0().Applicative0()))(p(j(r.MonadST5())))([ut(MD)(Cp.value)(u),ut(jv)(Gu.value)("video/mp4")]))([])])})(ol()()("https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4")(ol()()("https://www.w3schools.com/jsref/movie.mp4")(wv))))(function(u){return function(o){var c=al()()()()()({reflectType:function(){return 1}})(z.value)(u),l=al()()()()()({reflectType:function(){return 0}})(z.value)(u),v=Au(me(r.MonadST5()))(g(Qe(_e)))(n),s=function(){var m=ff(r)(Rn(r))(function(b){return b?l:c});return function(b){return m(v(b))}}();return Kt(r)([De(r)(p(j(r.MonadST5()))(ut(gr)(lr.value)(cr(g(e(void 0))))))([qt(r.MonadST5())("Switch videos")]),Kt(r)([s(!0),s(!1)])])}})))})}))),next:Dr(ct)(d(r.MonadST5().Monad0().Applicative0()))(p(j(r.MonadST5())))([ut(gr)(lr.value)(cr(function(e){return mt(or)(mt(or)(Wr(e))(t.dpage(Ua.value)))(ue)})),ut(Br)(Ir.value)(t.slug+"ssr/")])})}};var xT=function(){return z.value}(),wT=function(){return z.value}(),zD=function(t){return function(r){return Hr({reflectType:function(){return`<div>
  <h1>PursX 1</h1>

  <h2>Like JSX... but better!</h2>

  <p>Writing out PureScript code for the DOM only really makes sense if you're doing some sort of interesting manipulations on the JS layer. Otherwise, it's pretty tedious and longer than HTML. Thankfully, there's a solution: PursX.</p>

  <p>PursX takes its name from JSX and it accomplishes a similar goal: the ability to embed HTML in your document. In the example below, we create the same exact component from the previous article, but in PursX.</p>

  ~code~

  <p>Here's what it produces:</p>

  <blockquote> ~result~ </blockquote>

  <h2>Puurrrrrr ...sx</h2>

  <p>Static Pursx (meaning Pursx without any dynamic content) can be activated with the function <code>psx</code>.</p>

  <h2>Next steps</h2>
  <p>In this section, we used PursX to build the same component as the previous section. In the next section, we'll learn how to respond to <a ~next~ style="cursor:pointer;">events</a>.</p>
</div>`}})()()(ar()(Gr()(ar()(Lr(r.MonadST5().Monad0().Applicative0()))({reflectType:function(){return"result"}})({reflectSymbol:function(){return"result"}})(r))({reflectType:function(){return"next"}})({reflectSymbol:function(){return"next"}})(r))({reflectType:function(){return"code"}})({reflectSymbol:function(){return"code"}})(r))(r)(xT)({code:ur(Fr(r)([$r(r)([qt(r.MonadST5())(hl)])])),result:ur(tm({reflectType:function(){return`<div>
    <button>I do nothing</button>
    <ul>
        <li>A</li>
        <li>B</li>
        <li>C</li>
    </ul>
    <div>
        <a href="https://example.com">foo</a>
        <i>bar</i>
        <span style="font-weight:800;">baz</span>
    </div>
    <div><div></div><div><input type="range"/></div></div>
    </div>
`}})()(r)(Lr(r.MonadST5().Monad0().Applicative0()))(wT)),next:Dr(ct)(d(r.MonadST5().Monad0().Applicative0()))(p(j(r.MonadST5())))([ut(gr)(lr.value)(cr(function(e){return mt(or)(mt(or)(Wr(e))(t.dpage(Na.value)))(ue)})),ut(Br)(Ir.value)(t.slug+"events1/")])})}};var LT=function(){return z.value}(),PT=function(){return z.value}(),VD=function(t){return function(r){return Tl({reflectType:function(){return`<div>
  <h1>Pursx 2</h1>

  <h2>Working with events and effects</h2>
  <p>
    PursX would be of limited utility if it could only render static content. In this section, we'll see how to make it dynamic, both by modifying existing elements and inserting entirely new ones.
  </p>

  <p>The example below is the same one from the Pursx 1 section with two differences. The first is that the background color of the second list item is set dynamically. The second is that there is a new button that is dynamically inserted.
  </p>

  ?code?

  <p>And here's what it produces:</p>

  <blockquote> ?result? </blockquote>

  <h2>Dynamism in static content</h2>
  <p>Named slots for dynamic content are added to PursX with between two tildes, like <code>~foo~</code>. This separator doesn't have to be a tilde - it can be set programatically as well (see the Deku/Pursx.purs module for an example of how that is done). Also, we no longer use the <code>psx</code> command. Instead, we use the infix operator <code>~~</code> followed by arguments to our template. In the case of dynamic attributes, the argument is a stream of attributes. In the case of a dynamic section, the arguments are of type <code>Element</code>.</p>

  <h2>Next steps</h2>
  <p>In more complicated apps, like this documentation, we'll need dynamic logic that allows for components to replace each other, for example in a navigation bar. In the next section, we'll see one way to do this by using <a ?next? style="cursor:pointer;">events to control the presence and absence of elements</a>.</p>
</div>`}})({reflectType:function(){return"?"}})()()(r)(ar()(Gr()(ar()(Lr(r.MonadST5().Monad0().Applicative0()))({reflectType:function(){return"result"}})({reflectSymbol:function(){return"result"}})(r))({reflectType:function(){return"next"}})({reflectSymbol:function(){return"next"}})(r))({reflectType:function(){return"code"}})({reflectSymbol:function(){return"code"}})(r))(z.value)(LT)({code:ur(Fr(r)([$r(r)([qt(r.MonadST5())(Sl)])])),result:ur(xa(r)(en(r))(yu(r)(r.Always2())(function(e){return function(n){return p(j(r.MonadST5()))(Xu(Hr({reflectType:function(){return`<div>
        <button>I do nothing</button>
        <ul>
          <li>A</li>
          <li ~myli~>B</li>
          <li>C</li>
        </ul>
        <div>
          <a href="https://github.com/mikesol/purescript-deku"></a>
          <i>bar</i>
          ~somethingNew~
          <span style="font-weight:800;">baz</span>
        </div>
        <div><div></div><div><input type="range"/></div></div>
      </div>
`}})()()(Gr()(ar()(Lr(r.MonadST5().Monad0().Applicative0()))({reflectType:function(){return"somethingNew"}})({reflectSymbol:function(){return"somethingNew"}})(r))({reflectType:function(){return"myli"}})({reflectSymbol:function(){return"myli"}})(r))(r)(PT)({myli:p(j(r.MonadST5()))(ut(qv)(fe.value)("background-color:rgb(200,240,210);")),somethingNew:ur(De(r)(p(j(r.MonadST5()))(ut(wa)(lr.value)(e(new C(void 0)))))([Be(r.MonadST5())(ft(Vt(r.MonadST5().Monad0().Applicative0()))(N(Zt)(zu(ho(r.MonadST5().Monad0().Applicative0()))(n))("Thanks for clicking me!"))(p(j(r.MonadST5()))("I was dynamically inserted")))]))})))}}))),next:Dr(ct)(d(r.MonadST5().Monad0().Applicative0()))(p(j(r.MonadST5())))([ut(gr)(lr.value)(cr(function(e){return mt(or)(mt(or)(Wr(e))(t.dpage(Ha.value)))(ue)})),ut(Br)(Ir.value)(t.slug+"events2/")])})}};var JD=(t,r,e,n)=>{t(u=>n.units[u].main.appendChild(n.units[r].main))(e)},wp=t=>()=>{t.hydrating=!0},Ip=t=>()=>{t.hydrating=!1},jD=t=>r=>()=>{r.units[t.id].main.parentNode||(typeof t.pos.value0=="number"&&r.units[t.parent].main.children[t.pos.value0]?r.units[t.parent].main.insertBefore(r.units[t.id].main,r.units[t.parent].main.children[t.pos.value0]):t.parent.indexOf("@!%")!==-1?r.units[t.parent].main.parentNode.replaceChild(r.units[t.id].main,r.units[t.parent].main):r.units[t.parent].main.appendChild(r.units[t.id].main))},XD=t=>r=>e=>()=>{var n,u=r.id;e.scopes[r.scope]||(e.scopes[r.scope]=[]),e.scopes[r.scope].push(u),e.hydrating&&t&&r.parent.value0&&(n=document.body.querySelectorAll("[data-deku-ssr-"+u+"]").item(0))?e.units[u]={listeners:{},parent:r.parent,scope:r.scope,main:n}:e.units[u]={listeners:{},parent:r.parent,scope:r.scope,main:document.createElement(r.tag)}},GD=t=>r=>e=>n=>()=>{var u=e.id,o;if(n.scopes[e.scope]||(n.scopes[e.scope]=[]),n.scopes[e.scope].push(u),n.hydrating&&t&&e.parent.value0&&(o=document.body.querySelectorAll("[data-deku-ssr-"+e.parent.value0+"]").item(0))){var c=0;if(o.childNodes.length===1)o.prepend(document.createTextNode(""));else for(var c=0;c<o.childNodes.length;c++)if(o.childNodes[c].nodeType===8&&o.childNodes[c].nodeValue===u){c=c-1;break}n.units[u]={main:o.childNodes[c],parent:e.parent,scope:e.scope}}else n.units[u]={main:document.createTextNode(""),parent:e.parent,scope:e.scope},JD(r,u,e.parent,n)};function Lp(){return{units:{},scopes:{}}}var QD=t=>r=>e=>()=>{var n=r.id,u=r.value;e.hydrating&&t&&!e.units[n]&&(dom=document.body.querySelectorAll("[data-deku-ssr-"+n+"]").item(0))&&(e.units[n]={listeners:{},parent:r.parent,scope:r.scope,main:dom},e.scopes[r.scope]||(e.scopes[r.scope]=[]),e.scopes[r.scope].push(n)),e.units[n].main.tagName==="INPUT"&&r.key==="value"?e.units[n].main.value=u:e.units[n].main.tagName==="INPUT"&&r.key==="checked"?e.units[n].main.checked=u==="true":e.units[n].main.setAttribute(r.key,u)},YD=t=>r=>e=>()=>{var n=r.id,u=r.value;if(e.hydrating&&t&&!e.units[n]&&(dom=document.body.querySelectorAll("[data-deku-ssr-"+n+"]").item(0))&&(e.units[n]={listeners:{},parent:r.parent,scope:r.scope,main:dom},e.scopes[r.scope]||(e.scopes[r.scope]=[]),e.scopes[r.scope].push(n)),r.key==="@self@")u(e.units[n].main)();else{e.units[n].listeners[r.key]&&e.units[n].main.removeEventListener(r.key,e.units[n].listeners[r.key]);var o=c=>u(c)();e.units[n].main.addEventListener(r.key,o),e.units[n].listeners[r.key]=o}},ZD=t=>r=>()=>{var e=t.id;r.units[e].main.nodeValue=t.text},KD=t=>r=>e=>n=>()=>{var u,o,c=e.id,l=e.html,v=e.verb,s=e.cache,m=e.parent,b=e.scope,D=e.pxScope;if(n.hydrating&&t&&e.parent.value0&&(u=document.body.querySelectorAll("[data-deku-ssr-"+c+"]").item(0)))n.units[c]={listeners:{},scope:b,parent:m,main:u};else{let A=Object.entries(s);for(var a=0;a<A.length;a++){let Q=A[a][0];A[a][1]===!0?l=l.replace(v+Q+v,'data-deku-attr-internal="'+Q+'"'):l=l.replace(v+Q+v,'<span style="display:contents;" data-deku-elt-internal="'+Q+'"></span>')}o=document.createElement("div"),o.innerHTML=l.trim(),n.units[c]={listeners:{},scope:b,parent:m,main:o.firstChild}}n.scopes[b]||(n.scopes[b]=[]),n.scopes[b].push(c),o||(o=u),o.querySelectorAll("[data-deku-attr-internal]").forEach(function(A){var Q=A.getAttribute("data-deku-attr-internal");let Pt=Q+"@!%"+D;n.units[Pt]={listeners:{},main:A,scope:b},n.scopes[b].push(Pt)}),o.querySelectorAll("[data-deku-elt-internal]").forEach(function(A){var Q=A.getAttribute("data-deku-elt-internal");let Pt=Q+"@!%"+D;n.units[Q+"@!%"+D]={listeners:{},main:A,scope:b},n.scopes[b].push(Pt)}),u||JD(r,c,m,n)},tb=t=>r=>()=>{var e=t.id;r.units[e]={main:t.root}},rb=t=>r=>()=>{var e=t.id,n=t.parent;r.units[e].containingScope=t.scope,r.units[n].main.prepend(r.units[e].main)},eb=t=>r=>()=>{var e=t.id;r.units[e].noop||r.units[e].containingScope&&!t.scopeEq(r.units[e].containingScope)(t.scope)||r.units[e].main.remove()},nb=t=>r=>()=>{delete r.units[t.id]},ub=t=>r=>()=>{var e=t.id,n=t.pos,u=r.units[e].main.parentNode;u.insertBefore(r.units[e].main,u.children.length<=n?u.children[u.children.length-1]:n<0?u.children[0]:u.children[n])};var ab=function(t){return t};var WT=1,Pp=2147483647,UT=function(){return Pp-1|0}(),Op=function(t){var r=function(e){return function(n){return function(u){var o=n-e|0,c=oo(oi)(u)(o),l=c<e;return l?c+n|0:c}}};return r(WT)(UT)(t)};var qT=0,zT=48271,ob=function(t){return function(r){return Ee()(Of(zo(Ce(zT)*Ce(r)+Ce(t))(Ce(Pp))))}},ib=ob(qT);var YT=function(){function t(c){this.fn=c}var r={},e=function(c,l){this.head=c,this.tail=l};function n(c){return new e(c,r)}function u(c){return function(l){return new e(c,l)}}function o(c){for(var l=[],v=c;v!==r;)l.push(v.head),v=v.tail;return l}return function(c){return function(l){return function(v){var s=function(b,D){return c(l(u)(v(b)))(D)},m=function(b,D,a){if(D===0)return b;var A=a[D-1];return new t(function(){var Q=m(s(A,b),D-1,a);return Q})};return function(b){for(var D=l(n)(v(b[b.length-1])),a=m(D,b.length-1,b);a instanceof t;)a=a.fn();return l(o)(a)}}}}}();var Xa=function(t){return{map:function(r){return function(e){return function(n){return k(t)(function(u){return new H(r(u.value0),u.value1)})(e(n))}}}}};var Bp=function(t){return{Applicative0:function(){return Ku(t)},Bind1:function(){return Vf(t)}}},Vf=function(t){return{bind:function(r){return function(e){return function(n){return L(t.Bind1())(r(n))(function(u){var o=e(u.value0);return o(u.value1)})}}},Apply0:function(){return Jf(t)}}},Jf=function(t){return{apply:Ke(Bp(t)),Functor0:function(){return Xa(t.Bind1().Apply0().Functor0())}}},Ku=function(t){return{pure:function(r){return function(e){return p(t.Applicative0())(new H(r,e))}},Apply0:function(){return Jf(t)}}};var jo=function(t){return{state:function(r){var e=p(t.Applicative0());return function(n){return e(r(n))}},Monad0:function(){return Bp(t)}}};var mb=function(t){return function(r){var e=t(r);return e.value1}},Db=function(t){return function(r){var e=t(r);return e.value0}};var sS=function(t){return t};var vS=function(){var t=function(r){return new H(ab(r.newSeed),function(){var e={};for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n]);return e.newSeed=ib(r.newSeed),e}())};return Bn(jo(mr))(t)}();var Xo=Xa(gn);var Wp=function(t){return Db(sS(t))};var Ab=Jf(mr),db=function(t){return function(r){var e=Ce(r),n=Ce(t),u=function(l){return n+zo(l)(e-n+1)},o=k(Xo)(Ce)(vS),c=It(Ab)(k(Xo)(Pr(no))(o))(k(Xo)(Ve(no)(2))(o));return k(Xo)(function(l){return lp(u(l))})(c)}},kb=function(t){return function(r){var e=t<=r;return e?db(t)(r):db(r)(t)}};var Up=function(t){return t.arbitrary};var qp=function(){return{arbitrary:kb(-1e6)(1e6)}}();var Go=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),Qo=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),jf=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),Xf=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),Yo=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),DS=function(t){return function(r){return at(yr)(Rr(function(e){return W(sr)(e)([new Yo(t)])})(r))}},bS=function(t){return function(r){return at(yr)(Rr(function(e){return W(sr)(e)([new Xf(t)])})(r))}},dS=function(t){return function(r){return at(yr)(Rr(function(e){return W(sr)(e)([new Qo(t)])})(r))}},AS=function(t){return function(r){return at(yr)(Rr(function(e){return W(sr)(e)([new jf(t)])})(r))}},kS=function(t){return function(r){return at(yr)(Rr(function(e){return W(sr)(e)([new Go(t)])})(r))}},gb=function(t){return{ids:function(){var e=_r(t)(),n=tt(je)(Wp(Up(qp))({newSeed:Op(e),size:5}));return at(yr)(Rr(Pr(Le)(1))(t))(),n},makeElement:kS,attributeParent:function(r){return function(e){return p(se)(void 0)}},makeRoot:function(r){return function(e){return p(se)(void 0)}},makeText:dS,makePursx:AS,setProp:bS,setCb:function(r){return function(e){return p(se)(void 0)}},setText:DS,sendToPos:function(r){return function(e){return p(se)(void 0)}},deleteFromCache:function(r){return function(e){return p(se)(void 0)}},giveNewParent:function(r){return function(e){return p(se)(void 0)}},disconnectElement:function(r){return function(e){return p(se)(void 0)}}}},Cb=function(t){return{ids:function(){var e=vu(t)(),n=tt(je)(Wp(Up(qp))({newSeed:Op(e),size:5}));return at(O)(xc(Pr(Le)(1))(t))(),n},makeElement:XD(!0),attributeParent:jD,makeRoot:tb,makeText:GD(!0)(Qt(void 0)),makePursx:KD(!0)(Qt(void 0)),setProp:QD(!0),setCb:YD(!0),setText:ZD,sendToPos:ub,deleteFromCache:nb,giveNewParent:rb,disconnectElement:eb}};var zp=t=>t.replace(/[\u00A0-\u9999<>\&]/g,function(r){return"&#"+r.charCodeAt(0)+";"}),Vp=({id:t,html:r,pxScope:e,cache:n,verb:u})=>{let o=r,c=Object.entries(n);for(var l=0;l<c.length;l++){let b=c[l][0];c[l][1]===!0?o=o.replace(u+b+u,'data-deku-attr-internal="'+b+'" data-deku-ssr-'+b+"@!%"+e+'="true"'):o=o.replace(u+b+u,'<span style="display:contents;" data-deku-elt-internal="'+b+'" data-deku-ssr-'+b+"@!%"+e+'="true"></span>')}let v=o.indexOf(">"),s=o.indexOf("/>"),m=s==v-1?s:v;return o.slice(0,m)+" data-deku-ssr-"+t+'="true" '+o.slice(m)};var Sb=function(t){return function(r){var e=function(b){return function(D){return at(Xa(gn))(Va(jo(mr))(function(a){var A={};for(var Q in a)({}).hasOwnProperty.call(a,Q)&&(A[Q]=a[Q]);return A.idToActions=wn(re)(function(Pt){if(Pt instanceof C)return new C(W(sr)(Pt.value0)([D]));if(Pt instanceof w)return new C([D]);throw new Error("Failed pattern match at Deku.SSR (line 46, column 17 - line 48, column 45): "+[Pt.constructor.name])})(b)(a.idToActions),A}))}},n=function(b){return function(D){return function(a){return jt(Xt)(Vf(mr))(at(Xa(gn))(Va(jo(mr))(function(A){var Q={};for(var Pt in A)({}).hasOwnProperty.call(A,Pt)&&(Q[Pt]=A[Pt]);return Q.parentToChild=wn(re)(function(tr){if(tr instanceof C)return new C(W(sr)(tr.value0)([D]));if(tr instanceof w)return new C([D]);throw new Error("Failed pattern match at Deku.SSR (line 33, column 17 - line 35, column 41): "+[tr.constructor.name])})(b)(A.parentToChild),Q})))(function(){return e(D)(a)})}}},u=mb(ke(Qn)(Ku(mr))(function(b){if(b instanceof Go)return qr(Ku(mr))(zr)(b.value0.parent)(function(D){return n(D)(b.value0.id)(b)});if(b instanceof Qo)return qr(Ku(mr))(zr)(b.value0.parent)(function(D){return n(D)(b.value0.id)(b)});if(b instanceof jf)return qr(Ku(mr))(zr)(b.value0.parent)(function(D){return n(D)(b.value0.id)(b)});if(b instanceof Xf||b instanceof Yo)return e(b.value0.id)(b);throw new Error("Failed pattern match at Deku.SSR (line 56, column 17 - line 63, column 43): "+[b.constructor.name])})(r))({parentToChild:xn,idToActions:xn}),o=function(b){return na(Wc(function(D){return D instanceof Go||D instanceof Qo})(b))},c=function(b){return pe("")(Hi(function(D){return D instanceof Go?new C(D.value0.tag):w.value})(b))},l=function(b){return Jn(ct)(io)(" ")(ye(ov)(function(D){return D instanceof Xf?new C(D.value0.key+('="'+(D.value0.value+'"'))):w.value})(b))},v=function(b){return Qt("")(function(D){var a=function(Pt){return pe("")(Hi(function(tr){return tr instanceof Yo?new C(zp(tr.value0.text)+("<!--"+(b+"-->"))):w.value})(D))},A=function(Pt){var tr=c(D),zt=l(D);return"<"+(tr+(" "+(zt+(" data-deku-ssr-"+(b+('="true">'+(s(b)+("</"+(tr+">")))))))))},Q=Uu(D)(0);return Q instanceof C&&Q.value0 instanceof Yo?a(void 0):Q instanceof C&&Q.value0 instanceof Qo?a(void 0):Q instanceof C&&Q.value0 instanceof jf?Vp(Q.value0.value0):A(void 0)})(Ca(re)(b)(u.idToActions))},s=function(b){var D=pe([])(Ca(re)(b)(u.parentToChild));return xr(ct)(io)(v)(D)},m=function(b){return Ye(Xr)(function(D){return function(a){return function(A){var Q=o(A);if(Q)return a;if(!Q)return Ff("data-deku-ssr-"+D)(l(A)+(" data-deku-ssr-"+D))(a);throw new Error("Failed pattern match at Deku.SSR (line 83, column 19 - line 85, column 136): "+[Q.constructor.name])}}})(s(b))(u.idToActions)};return"<"+(t+(' data-deku-ssr-deku-root="true">'+(m("deku-root")+("</"+(t+">")))))}};var hb=function(t){return Pn(t.MonadST5().Monad0().Applicative0())(t.MonadST5())({doLogic:function(r){return function(e){return function(n){return e.sendToPos({id:n,pos:r})}}},ids:function(){var r=Er();return function(e){return function(n){return n.ids}(r(e))}}(),disconnectElement:function(r){return function(e){return r.disconnectElement({id:e.id,scope:e.scope,parent:e.parent,scopeEq:Et(Ea)})}},toElt:function(r){return r}})},uh=function(t){return function(){var e=Lp(),n=Ue(O)(Wu(0))(Cb)();wp(e)();var u=Nr(hb(ef)({parent:new C("deku-root"),scope:new ku("rootScope"),raiseId:function(o){return p(ie)(void 0)},pos:w.value})(n)(t))(function(o){return o(e)})();return Ip(e)(),u}},Eb=function(t){return at(O)(uh(t))},ah=function(t){return function(r){return function(e){return function(n){return k(t.MonadST5().Monad0().Bind1().Apply0().Functor0())(function(){var u=Sb(r);return function(o){return function(c){return e.head+c}(function(c){return c+e.tail}(u(o)))}}())(X(t.MonadST5())(function(){var o=kr(0)(),c=kr([])(),l=gb(o);return at(yr)(Nr(hb(rf)({parent:new C("deku-root"),scope:new ku("rootScope"),raiseId:function(v){return p(se)(void 0)},pos:w.value})(l)(n))(function(v){return v(c)}))(),_r(c)()}))}}}},$b=function(t){return ah(t)("body")};var oh=function(){return z.value}(),Mb=function(t){return nf()(t)()(ba({reflectSymbol:function(){return"buttonClicked"}})(da(Aa(t.Always2())(ja)))(ba({reflectSymbol:function(){return"sliderMoved"}})(da(Aa(t.Always2())(ja)))(Fi)()())()())(Sa({reflectSymbol:function(){return"buttonClicked"}})()()(Sa({reflectSymbol:function(){return"sliderMoved"}})()()(Qi)()()()())()()()())(z.value)(function(r){return function(e){return Kt(t)([Sp(t)([qt(t.MonadST5())(`Here's an example of SSR in deku.
All of the static bits are rendered as HTML,
and all of the dynamic bits are hydrated on page load.`)]),De(t)(zf(Zt)(Xe)(wa)(p(j(t.MonadST5()))(r.buttonClicked)))([qt(t.MonadST5())("Click")]),Kt(t)([Be(t.MonadST5())(ft(Vt(t.MonadST5().Monad0().Applicative0()))(p(j(t.MonadST5()))("Val: 0"))(k(Zt)(function(){var n=W(qn)("Val: "),u=tt(je);return function(o){return n(u(o))}}())(Au(me(t.MonadST5()))(g(Pr(Le)(1)))(ft(Vt(t.MonadST5().Monad0().Applicative0()))(p(j(t.MonadST5()))(void 0))(e.buttonClicked))(-1))))]),Kt(t)([tu(t)(qf(t.MonadST5())(p(j(t.MonadST5()))(r.sliderMoved)))([]),Kt(t)([Be(t.MonadST5())(ft(Vt(t.MonadST5().Monad0().Applicative0()))(p(j(t.MonadST5()))("Val: 50"))(k(Zt)(function(){var n=W(qn)("Val: "),u=tt(ao);return function(o){return n(u(o))}}())(e.sliderMoved)))])])])}})},xb=function(t){return function(r){return Hr({reflectType:function(){return`<div>
  <h1>Server-side rendering</h1>

  <h2>When performance matters!</h2>
  <p>
    In web development, it's good practice to send a plain-HTML version of your site over the wire before any JavaScript starts executing. This is called <i>server-side rendering</i>, or SSR, where the server renders HTML in an initial pass before rendering any JavaScript.
  </p>
  <p>
    The most performant form of SSR is pre-rendering HTML and serving them from memory or from a file system. This is Deku's strategy via the following two functions:
  </p>
  <ul>
    <li><code>runSSR</code> generates HTML; and</li>
    <li><code>hydrate</code> generates JavaScript that will hydrate your HTML with anything that's dynamic. Note that this is <i>partial</i> hydration, meaning it will only hydrate the bits that need hydrating. This means that, for example, you can do CSS animations on load without fear of jank when the JavaScript kicks in.</li>
  </ul>

  <p>
    This documentation is generated using SSR, and if you add <code>view-source:</code> before the URL, you'll see the intro page rendered as HTML. If you're reading this documentation on a computer screen, you won't see much of a difference, but if you're reading it on a 3G mobile network, you'll spot the difference immedaitely.
  </p>

  <h2>A motivating example</h2>

  <p>Here is a small application using SSR. We'll split it up into three files:</p>
  <ul>
    <li><code>App.purs</code> has our application logic.</li>
    <li><code>Build.purs</code> creates a <code>.js</code> file, for example <code>make.js</code>, that will render our HTML.</li>
    <li><code>Live.purs</code> uses hydration to add dynamic logic to the website.</li>
  </ul>

  <h3>App</h3>
  <p>Unlike the previous examples that used <code>runInBody</code>, our application code here has an explicit type annotation <code>Nut</code>. The definition of <code>Nut</code> is <code>type Nut = forall s m lock payload. Korok s m => Domable m lock payload</code>, and in larger projects, you may need to write this type out explicitly, for example if you are working with an <code>Array</code> of <code>Domable</code> and need <code>m</code> to be consistant over the <code>Array</code>.</p>
  ~code0~
  <h3>Build</h3>
  <p>This is the code we use to generate our HTML site. The example below creates a small script that logs our HTML to the command line,but we can also call <code>runSSR</code> from a NodeJS server, in which case we wouldn't <code>log</code> the HTML string but rather we would instead send it over the wire as the response to a request.</p>
  ~code1~
  <h3>Live</h3>
  <p><code>Live.purs</code> can be bundled to generate our dynamic JS. The JS will hydrate our elements instead of replacing them, and will only hydrate elements that potentially will interactive content.</p>
  ~code2~

  <h3>Result</h3>

  <p>Here is the resulting code from our static-site generation. It is rendered dynamically in your browser, but in production settings, we'd use NodeJS to render or pre-render this HTML.</p>

  ~codegen~

  <p>And here is what the result looks like after hydration.</p>

  <blockquote> ~result~ </blockquote>

  <h2>Parting shot</h2>
  <p>Thanks for checking out Deku! I had a blast writing it, and I hope you enjoy using it for your projects!</p>
</div>`}})()()(ar()(ar()(ar()(ar()(ar()(Lr(r.MonadST5().Monad0().Applicative0()))({reflectType:function(){return"result"}})({reflectSymbol:function(){return"result"}})(r))({reflectType:function(){return"codegen"}})({reflectSymbol:function(){return"codegen"}})(r))({reflectType:function(){return"code2"}})({reflectSymbol:function(){return"code2"}})(r))({reflectType:function(){return"code1"}})({reflectSymbol:function(){return"code1"}})(r))({reflectType:function(){return"code0"}})({reflectSymbol:function(){return"code0"}})(r))(r)(oh)({code2:ur(Fr(r)([$r(r)([qt(r.MonadST5())(Pl)])])),code1:ur(Fr(r)([$r(r)([qt(r.MonadST5())(Ll)])])),code0:ur(Fr(r)([$r(r)([qt(r.MonadST5())(Il)])])),result:ur(Mb(r)),codegen:ur(Fr(r)([$r(r)([Be(r.MonadST5())(ne(function(e){return mt(r.MonadST5().Monad0().Bind1().Apply0())(L(r.MonadST5().Monad0().Bind1())($b(r)({head:'<!DOCTYPE html><html><head><script src="bundle.js" defer><\/script></head>',tail:"</html>"})(Mb(rf)))(e))(p(r.MonadST5().Monad0().Applicative0())(p(r.MonadST5().Monad0().Applicative0())(void 0)))}))])]))})}};var wb=function(t){return function(r){var e=function(u){if(u instanceof sf)return UD;if(u instanceof La)return WD;if(u instanceof Pa)return um;if(u instanceof Oa)return zD;if(u instanceof Na)return ND;if(u instanceof Ba)return hD;if(u instanceof Ra)return VD;if(u instanceof Ha)return HD;if(u instanceof Wa)return qD;if(u instanceof Ua)return xb;throw new Error("Failed pattern match at Deku.Example.Docs.Scene (line 95, column 3 - line 95, column 25): "+[u.constructor.name])},n=function(u){return function(o){return e(o)({dpage:u,slug:t.slug})(r)}};return $a(r)(r.Always2())(function(u){return Me(ge)(function(o){return ft(Vt(r.MonadST5().Monad0().Applicative0()))(p(j(r.MonadST5()))(t.startsWith))(o)})(function(o){return Kt(r)([Kt(r)(k(Ar)(function(c){return Dl(r)([wo(r)(Dr(ct)(d(r.MonadST5().Monad0().Applicative0()))(p(j(r.MonadST5())))([ut(gr)(lr.value)(cr(function(l){return mt(or)(Wr(l))(u(c.value0))})),ut(Vv)(fe.value)("cursor:pointer;"),ut(Br)(Ir.value)(t.slug+c.value1.value1.value0)]))([qt(r.MonadST5())(c.value1.value0)]),Rn(r)(p(j(r.MonadST5()))(ut(Ia)(fe.value)(function(){return c.value1.value1.value1?"":"display:none;"}())))([qt(r.MonadST5())(" | ")])])})([new H(sf.value,new H("Home",new H("",!0))),new H(La.value,new H("Hello world",new H("hello/",!0))),new H(Pa.value,new H("Component",new H("simple/",!0))),new H(Oa.value,new H("Pursx 1",new H("pursx1/",!0))),new H(Na.value,new H("Events 1",new H("events1/",!0))),new H(Ba.value,new H("Effects",new H("effects/",!0))),new H(Ra.value,new H("Pursx 2",new H("pursx2/",!0))),new H(Ha.value,new H("Events 2",new H("events2/",!0))),new H(Wa.value,new H("Portals",new H("portals/",!0))),new H(Ua.value,new H("SSR",new H("ssr/",!1)))])),ff(r)(en(r))(n(u))(o)])})})}};var aAt=function(t){return function(){var e=Qt(Po(za("could not ingest options: "+tt(b_()()(tc({reflectSymbol:function(){return"slug"}})(tc({reflectSymbol:function(){return"startsWith"}})(m_)(Ae))(Ae)))(t))))(p(ie))(Kv(t.startsWith))();return Eb(wb({slug:t.slug,startsWith:e})(ef))()}};export{aAt as main};
